(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"./assets/action/buttonActions.ts":function(e,t,n){"use strict";var a=n("./assets/lib/ajax.ts"),i=n("./assets/const/API.ts"),s=n("./node_modules/antd/es/message/index.js"),o=n("./assets/lib/handy.ts"),l=n("./node_modules/braft-editor/dist/index.js"),r=function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,l)}r((a=a.apply(e,t||[])).next())})};const u=n("./node_modules/urijs/src/URI.js"),c=n("./node_modules/shortid/index.js");var m=n("./assets/action/freshTableList.ts"),d=n("./common/SYSTEM.js"),p=n.n(d),y=n("./assets/action/informServer.ts"),f=n("./node_modules/antd/es/modal/index.js"),h=n("./assets/reducer/index.ts"),N=n("./assets/const/SITE_INFO.ts"),T=n("./assets/lib/distribution.ts"),v=function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,l)}r((a=a.apply(e,t||[])).next())})};const E=n("./node_modules/shortid/index.js"),g=n("./node_modules/lc-ajax/index.js"),S=n("./node_modules/urijs/src/URI.js"),k="/"+p.a.urlVersion.value,I=[];I.push({name:"toggleContentEditModal",action:function(e){return v(this,void 0,void 0,function*(){const t=this.props.fields.find(e=>e.isPrimaryKey).keyName,n=e[t];let m,d;n?(yield this.props.dispatch({type:"table.setValue",key:"editingId",value:n}),function(e,t){r(this,void 0,void 0,function*(){console.log("record: ",t);const n=e.dispatch;if(!e.editingId)return;const r=e.fields.find(e=>e.isPrimaryKey).detailConfig;let m=i.a.getOneFromTable.url;r&&r.api&&(m=r.api);const d=new u(m);if(r){const e=r.argMap;Object.keys(e).forEach(n=>{const a=e[n];console.log("key: ",n),d.setQuery(n,t[a])})}else d.setQuery("tableName",e.tableName),d.setQuery("dbName",e.dbName),d.setQuery("keyName",e.dbName),d.setQuery("keyValue",e.editingId);let p=e.fields;p.forEach(e=>{e.keyName&&("wysiwyg"===e.type?n({type:"fields.setValue",value:l.EditorState.createFrom(),key:e.keyName}):n({type:"fields.setValue",value:null,key:e.keyName}))});const y=d.toString();let f;if(r&&r.isRedirect){const e=new u(i.a.serverRequest.url);e.setQuery("url",y),f=yield a.a.get(e.toString())}else f=yield a.a.get(y);if(200!==f.code)return void s.a.error("获取内容失败");let h=f.value;h?(p.forEach(e=>{const t=e.keyName;let a;if(a=o.a.isValuePath(e.keyName)?o.a.getValueByPath(h,e.keyName):h[t],t)if(["image","images","file"].includes(e.type)){if(!a)return;if("string"==typeof a)a=[a];else if(!Array.isArray(a))throw new Error("Can not normalize this value of file.");const i=a.map(t=>{const n=new u(t),a=c.generate();return{uid:a,url:t,name:"file"===e.type?n.filename():a,status:"done"}});n({type:"fields.setValue",value:i,key:t})}else if("wysiwyg"===e.type){const e=document.createElement("template");e.innerHTML=a;const i=e.content.querySelectorAll("img");[].forEach.call(i,function(e){if(!e.src){const t=e.getAttribute("data-src");t&&e.setAttribute("src",t)}}),a=e.innerHTML,n({type:"fields.setValue",value:l.EditorState.createFrom(a),key:t})}else n({type:"fields.setValue",value:a,key:t})}),n({type:"table.setValue",value:h,key:"originalFields"}),n({type:"table.setValue",value:e.fields,key:"fields"})):s.a.error("接口返回空的内容")})}(this.props,e),m="编辑",d=!0):(console.log("add new content"),this.props.fields.forEach(e=>{if(void 0!==e.defaultValue)e.keyName&&h.default.dispatch({type:"fields.setValue",value:e.defaultValue,key:e.keyName});else if(e.source){const t=e.source,n=(new S).query(!0);let a;if("url"!==t.from)throw new Error("This is not a valid source property, please check document.");a=t.keyName?n[t.keyName]:n[e.keyName],console.log("source value: ",a),h.default.dispatch({type:"fields.setValue",value:a,key:e.keyName})}else h.default.dispatch({type:"fields.setValue",value:void 0,key:e.keyName})}),m="新建",d=!1),this.props.dispatch({type:"modal.toggle",modalName:"contentEditModal",options:{modalTitle:m,isEditing:d}}),this.props.dispatch({type:"table.setValue",value:{isEdited:!1}})})}}),I.push({name:"deleteItem",action:function(e){return v(this,void 0,void 0,function*(){const t=this.props.fields.find(e=>!!e.isPrimaryKey),n=t.deleteConfig||{},o=n&&n.deleteText||"删除后不能恢复，确定？";if(!1===window.confirm(o))return;let l=i.a.deleteOneFromTable.url;n.api&&(l=n.api);const r={};n.argMap?Object.keys(n.argMap).forEach(t=>{const a=n.argMap[t];let i="";if("string"==typeof a?i=a:(i=a.keyName,"string"===a.type&&(e[i]=e[i]+"")),n.method&&"GET"===n.method.toUpperCase()){const n=new S(l);n.setQuery(t,e[i]),l=n.toString()}else r[t]=e[i]}):(r.dbName=this.props.dbName,r.tableName=this.props.tableName,r.keyValue=e[t.keyName]);let u=g.post;if(n.method&&"GET"===n.method.toUpperCase()&&(u=a.a.get),n.isRedirect){const e=new S(i.a.serverRequest.url);e.setQuery("url",l),l=e.toString()}let c="json";"URLENCODED"===n.enctype&&(c="URLENCODED");const m=yield u(l,r,{},c);200===m.code?(s.a.success("删除成功"),setTimeout(()=>this.freshList(),1),y.a.call(this)):s.a.error("删除失败："+m.message)})}}),I.push({name:"manageItem",action:function(e){return v(this,void 0,void 0,function*(){const t=this.props.fields.find(e=>!!e.isPrimaryKey),n=e[t.keyName];this.props.history.push(k+"/page/distribution/channel/distribution-manage?keyValue="+encodeURIComponent(n))})}}),I.push({name:"blockItemFromDis",action:function(e){return v(this,void 0,void 0,function*(){yield a.a.post(i.a.blockDistribution.url,{item:e});const t=new S;t.setQuery("page",1),yield this.props.setValue("page",1),this.props.history.push(t.pathname()+t.search())})}}),I.push({name:"pushUpItemFromDis",action:function(e){return v(this,void 0,void 0,function*(){const t=yield a.a.post(i.a.pushUpDistribution.url,{item:e});if(200===t.code){const e=new S;yield this.props.setValue("page",1),e.setQuery("page",1),this.props.history.push(e.pathname()+e.search())}else s.a.error(t.message)})}}),I.push({name:"deleteItemFromDis",action:function(e){return v(this,void 0,void 0,function*(){const t=yield a.a.post(i.a.removeTableRecord.url,{tableName:"T_CONTENT_DIS_FLITER",fields:{FDISID:e.disId,FCONTENT_ID:e.id}});if(200===t.code){const e=new S;e.setQuery("page",1),this.props.history.push(e.pathname()+e.search())}else s.a.error(t.message)})}}),I.push({name:"pullDownFromDis",action:function(e){return v(this,void 0,void 0,function*(){const t=yield a.a.post(i.a.updateTableRow.url,{tableName:"T_CONTENT_DIS_FLITER",fields:{FCONTENT_ID:e.id,FORDER:1}});if(200===t.code){const e=new S;e.setQuery("page",1),this.props.history.push(e.pathname()+e.search())}else s.a.error(t.message)})}}),I.push({name:"setItemStyleFromDis",action:function(e){return v(this,void 0,void 0,function*(){this.props.dispatch({type:"disManage.setValue",key:"isEditDisplayModalOpen",value:!0});const t=yield a.a.post(i.a.queryOne.url,{tableName:"T_CONTENT_DIS_DISPLAY",fields:{FCONTENT_ID:e.id}});if(200===t.code){const n=t.value;n.FID||(n.FDISID=e.disId,n.FCONTENT_ID=e.id,n.FDISPLAY_STYLE=e.displayStyle,n.FOPEN_TYPE=e.openType,n.FOPEN_URL=e.openUrl),delete n.FPOSITION,delete n.FUPDATE_TIME,delete n.FCREATE_TIME,this.props.dispatch({type:"disManage.setValue",key:"editingStyle",value:n})}})}}),I.push({name:"openCrawlTester",action:function(){this.props.dispatch({type:"modal.toggle",key:"crawlTest",isOpen:!0,options:{}})}}),I.push({name:"openVideoInput",action:function(){return v(this,void 0,void 0,function*(){yield h.default.dispatch({type:"videoInput.setValue",key:"isOpen",value:!0})})}}),I.push({name:"import",action:function({tableName:e}){return v(this,void 0,void 0,function*(){e=e||this.props.tableName;let t=document.getElementById("import-data");t||((t=document.createElement("input")).setAttribute("id","import-data"),t.setAttribute("type","file"),t.setAttribute("accept",".json"),t.style.display="none",document.body.appendChild(t)),t.onchange=(()=>{const n=t.files;if(n.length){const a=n[0],o=new FormData;o.append("data.json",a),o.append("tableName",e);const l=new XMLHttpRequest;l.open("POST",i.a.importData.url),l.onload=(()=>{t.value="";const e=JSON.parse(l.responseText);200===e.code?(s.a.success("上传成功."),m.a.call(this)):s.a.error(e.message)}),l.send(o)}console.log(n)}),t.click()})}}),I.push({name:"export",action:function({tableName:e}){return v(this,void 0,void 0,function*(){e=e||this.props.tableName;const t=new S(i.a.exportData.url);t.origin(window.location.origin),t.setQuery("tableName",e),window.location.assign(t.toString())})}}),I.push({name:"makeUrl",action:function(e){return v(this,void 0,void 0,function*(){yield h.default.dispatch({type:"modal.toggle",key:"makeUrl",isOpen:!0,options:e})})}}),I.push({name:"makeScheme",action:function(e){return v(this,void 0,void 0,function*(){yield h.default.dispatch({type:"modal.toggle",key:"makeScheme",isOpen:!0,options:e})})}}),I.push({name:"distribute",action:function(e){return v(this,void 0,void 0,function*(){yield h.default.dispatch({type:"modal.toggle",key:"distribute",isOpen:!0,options:e})})}});const C=function(e,t){return v(this,void 0,void 0,function*(){const n=new S(t);n.setQuery("id",e.id);const o=new S(i.a.serverRequest.url);o.setQuery("url",n.toString());const l=yield a.a.get(o.toString());200===l.code?(s.a.success("操作成功！"),this.freshList()):s.a.error(l.message)})};function _({status:e,contentId:t,cpId:n,cpEntityId:o}){return v(this,void 0,void 0,function*(){const l=new S("http://om.iflow.meizu.com/service/biz/contents/status");l.setQuery("status",e),l.setQuery("contentId",t),l.setQuery("cpEntityId",o),l.setQuery("cpId",n);const r=new S(i.a.serverRequest.url);r.setQuery("url",l.toString());const u=yield a.a.get(r.toString());200===u.code?(s.a.success("操作成功"),this.freshList()):s.a.error(u.message)})}I.push({name:"deleteSpecialContent",action:function(e){C.call(this,e,N.a.domain+"/service/article/special/del")}}),I.push({name:"offShelf",action:function(e){C.call(this,e,N.a.domain+"/service/article/notrelease")}}),I.push({name:"onShelf",action:function(e){return v(this,void 0,void 0,function*(){C.call(this,e,N.a.domain+"/service/article/release")})}}),I.push({name:"filter",action:function(e){return v(this,void 0,void 0,function*(){C.call(this,e,N.a.domain+"/service/article/special/add")})}}),I.push({name:"manageFunctionRule",action:function(e){return v(this,void 0,void 0,function*(){const t=this.props.fields.find(e=>e.isPrimaryKey);this.props.history.push(k+"/page/analysis/transfer/rule-manage?FFUNCTION_ID="+encodeURIComponent(e[t.keyName]))})}}),I.push({name:"stopDistribute",action:function(e){return v(this,void 0,void 0,function*(){console.log("item: ",e),f.a.confirm({title:"提示",content:"暂停下发后，此 CP 的内容即时停止下发，下个自然月开始自动启动下发",onOk:()=>v(this,void 0,void 0,function*(){const t=new S(i.a.serverRequest.url);t.setQuery("url","https://sge.meizu.com/msr/cpgroup/offline");const n=yield g.post(t.toString(),{cps:e.FCPID},{},"URLENCODED");if(200===n.code){200===(yield a.a.post(i.a.updateTableRow.url,{tableName:"T_CONTENT_VIEW_STATUS",fields:{FCPID:e.FCPID,FSTAT_DATE:e.FSTAT_DATE,FSTATUS:4}})).code?(s.a.success("操作成功"),m.a.call(this)):s.a.error("推荐平台操作成功，状态写入失败")}else-100===n.code?f.a.confirm({title:"",content:"无法获取当前账户的UAC信息或当前账户权限不足，请点击确定跳转到“通用权限平台”登录，查看“系统功能权限->cp下线”是否已授权，如已授权则返回当前页面，刷新后操作。",onOk:()=>{window.open("https://sct.meizu.com/?ssCode=sge","_blank")}}):s.a.error(n.message)})})})}}),I.push({name:"downloadCSV",action:function(){return v(this,void 0,void 0,function*(){m.a.call(this,{exposeType:"csv"})})}}),I.push({name:"searchAuthor",action:function(e){const t=e.FNAME;this.props.history.push("/v2/page/content-manage/article?author="+t)}}),I.push({name:"visitContent",action:function(e){return v(this,void 0,void 0,function*(){const t=window.open("");if([3,11].includes(e.type)){let n="";const o=window.location.protocol+"//om.iflow.meizu.com/service/article/playurl",l=new S(o);l.setQuery("cpEntityId",e.cpEntityId||e.uniqueId),l.setQuery("cpId",e.cpId||e.resourceType);const r=new S(i.a.serverRequest.url);r.setQuery("url",l.toString());const u=yield a.a.get(r.toString());if(200===u.code){const e=u.value;Array.isArray(e)&&e.length&&(n=e[0].mainUrl)}if(n||(n=e.link||e.h5Url),n){if("mp4"===new S(n).suffix()){const e=new S("/v2/html/videoPlayer");e.setQuery("videoUrl",n),t.location.href=e.toString()}else t.location.href=n}else s.a.error("找不到播放地址")}else{if(e.link)return void(t.location.href=e.link);if(e.h5Url)return void(t.location.href=e.h5Url)}})}}),I.push({name:"viewAuthorArticleList",action:function(e){return v(this,void 0,void 0,function*(){h.default.dispatch({type:"modal.toggle",modalName:"authorArticlesPreview",options:e})})}}),I.push({name:"selectAnalysisRule",action:function(e){h.default.dispatch({type:"modal.toggle",modalName:"selectAnalysisRule",options:e})}}),I.push({name:"publicArticle",action:function(){f.a.confirm({title:"发布",content:"编辑后的内容未经过审核，是否发布？",onOk:()=>v(this,void 0,void 0,function*(){yield this.submit(),I.find(e=>"onShelf"===e.name).action.call(this,this.props.formFields)}),okText:"确定",cancelText:"取消"})}}),I.push({name:"publicVideo",action:function(){f.a.confirm({title:"发布",content:"编辑后的内容未经过审核，是否发布？",onOk:()=>v(this,void 0,void 0,function*(){yield h.default.dispatch({type:"fields.setValue",value:{status:1}}),this.submit()}),okText:"确定",cancelText:"取消"})}}),I.push({name:"videoOffShelf",action:function(e){_.call(this,{status:2,contentId:e.contentId,cpId:e.cpId,cpEntityId:e.cpEntityId})}}),I.push({name:"videoOnShelf",action:function(e){_.call(this,{status:1,contentId:e.contentId,cpId:e.cpId,cpEntityId:e.cpEntityId})}});I.push({name:"crawlUrl",action:function(e){return v(this,void 0,void 0,function*(){const t=JSON.parse(JSON.stringify(this.props.fields)),n=t.find(t=>t.keyName===e.keyName),o=n.buttons.find(e=>"crawlUrl"===e.actionName);o.isLoading=!0,o.loadingTime=60,o.tempName="";const l=function(e){h.default.dispatch({type:"table.setValue",value:e})};l({fields:t});const r=function(e){clearInterval(e),o.isLoading=!1,o.tempName=null,l({fields:t})},u=setInterval(()=>{const n=this.props.fields.find(t=>t.keyName===e.keyName).buttons.find(e=>"crawlUrl"===e.actionName);n.isLoading&&n.loadingTime?(o.loadingTime=o.loadingTime-1,o.tempName=o.loadingTime,l({fields:t})):r(u)},1e3),c=yield a.a.post(i.a.crawlUrl.url,{url:this.props.formFields[n.keyName]});if(200===c.code){const e=c.value,n=JSON.parse(JSON.stringify(this.props.formFields)),a=function(e,t){n[e]=t};a("author",e.author),a("content",e.content),t.find(e=>"content"===e.keyName)._key=E.generate(),a("title",e.title),a("contentTitle",e.title),a("cpSource",e.source),a("imgUrls",e.imgMap.map(e=>(e.uid=E.generate(),e.name=e.id,e.status="done",e.thumbUrl=e.url,e))),a("keywords",e.keywords.join(",")),l({fields:t}),h.default.dispatch({type:"fields",value:n}),s.a.success("抓取成功")}else s.a.error(c.message);o.isLoading=!1,l({fields:t})})}}),I.push({name:"copy",action:function(e){const t=this.props.formFields[e.keyName],n=document.createElement("input");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),n.parentElement.removeChild(n)}}),I.push({name:"previewVideo",action:function(e){const t=this.props.formFields[e.keyName];window.open(t,"_blank")}}),I.push({name:"openBatchSet",action:function(e){h.default.dispatch({type:"modal.toggle",modalName:"batchSet",options:e})}}),I.push({name:"newGrabApi",action:function(e){const t=(new S).query(!0).cpId;this.props.history.push("/v2/page/analysis/cp-transfer/cp-api-list/cp-api-manage?cpId="+t)}});const b=function({tableName:e,fields:t}){return v(this,void 0,void 0,function*(){const n=yield a.a.post(i.a.updateTableRow.url,{tableName:e,fields:t});200===n.code?(s.a.success("数据保存成功"),this.props.freshList.call(this)):s.a.error("操作失败: "+n.message)})};I.push({name:"offlineCP",action:function(e){return s.a.error("该功能正在开发中")}}),I.push({name:"onlineCP",action:function(e){return s.a.error("该功能正在开发中")}}),I.push({name:"algorithmContentOnline",action:function(e){b.call(this,{tableName:"T_CONTENT_DIS",fields:{FID:e.FID,FSTATUS:1}}),T.a.freshCache.call(this,e.FID)}}),I.push({name:"algorithmContentOffline",action:function(e){b.call(this,{tableName:"T_CONTENT_DIS",fields:{FID:e.FID,FSTATUS:4}}),T.a.freshCache.call(this,e.FID)}});t.a=I},"./assets/action/freshTableList.ts":function(e,t,n){"use strict";var a=n("./assets/lib/ajax.ts"),i=n("./assets/const/API.ts"),s=n("./node_modules/antd/es/message/index.js"),o=function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,l)}r((a=a.apply(e,t||[])).next())})};n("./common/filter/index.js");const l=n("./node_modules/urijs/src/URI.js");t.a=function(e={}){return o(this,void 0,void 0,function*(){const t=e.exposeType,n=this.props;if(!n.tableName||!n.dbName)throw new Error("Can not find dbName and tableName.");const o=(new l).query(!0),r=n.page||1,u=n.pageSize||10;let c=n.dispatch;const m=i.a.queryTable.url,d={dbName:n.dbName,tableName:n.tableName,offset:(r-1)*u,pageSize:u},p={};if(n.queryFields.forEach(e=>{[null,void 0,""].includes(e.value)||(e.searchMode&&"LIKE"===e.searchMode.toUpperCase()?p[e.keyName]=`%${e.value}%`:p[e.keyName]=e.value)}),Object.keys(o).forEach(e=>{const t=n.fields.find(t=>t.keyName===e);t&&(p[e]=o[e],"number"===t.valueType&&(p[e]=+p[e]))}),Object.keys(p).length&&(d.filter=p),o.sortBy){const e=o.sortOrder||"ASC";d.sortBy=o.sortBy,d.sortOrder=e}if(t){d.exposeType=t;const e=new l(m);Object.keys(d).forEach(t=>{d[t]&&"object"==typeof d[t]?e.setQuery(t,encodeURIComponent(JSON.stringify(d[t]))):e.setQuery(t,d[t])}),window.location.assign(e.toString())}else{c({type:"table.setValue",value:[],key:"list"}),c({type:"table.setValue",value:0,key:"total"}),c({type:"table.setValue",value:!0,key:"isLoading"});const e=yield a.a.post(m,d);if(c({type:"table.setValue",value:!1,key:"isLoading"}),200===e.code&&e.value){const t=e.value;Array.isArray(t.list)&&(c({type:"table.setValue",value:t.list,key:"list"}),c({type:"table.setValue",value:t.total,key:"total"}))}else s.a.error(e.message)}})}},"./assets/action/informServer.ts":function(e,t,n){"use strict";var a=n("./node_modules/antd/es/message/index.js"),i=n("./assets/lib/ajax.ts"),s=n("./assets/const/API.ts"),o=function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,l)}r((a=a.apply(e,t||[])).next())})};const l=n("./node_modules/urijs/src/URI.js");t.a=function(){return o(this,void 0,void 0,function*(){const e=this.props.fields.find(e=>e.isPrimaryKey);if(e&&e.informServer){const t=new l(e.informServer.api),n=new l(s.a.serverRequest.url);n.setQuery("url",t.toString());const o=yield i.a.get(n.toString());200===o.code?a.a.success("刷新缓存成功"):a.a.error("刷新缓存失败，JAVA服务器返回信息："+o.message)}})}},"./assets/action/miscellaneous.ts":function(e,t,n){"use strict";var a=n("./assets/lib/ajax.ts"),i=n("./assets/const/API.ts"),s=function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,l)}r((a=a.apply(e,t||[])).next())})};const o=n("./node_modules/urijs/src/URI.js"),l={freeOrNotCP:[],chargeCP:[],maxExposeAmount:0,isRes:!1,channelOptions:[]},r=[{name:"initOMParameter",action:function(){return s(this,void 0,void 0,function*(){if(!0===l.isRes)return;const e=yield a.a.post(i.a.queryOne.url,{tableName:"T_OM_PARAMETER",selectFields:[{keyName:"FVALUE"}],filter:{FTYPE:"cp",FKEY:"view_count_limit"}});if(200===e.code){if(!e.value.FVALUE)return void console.error("配置平台未填写“收费CP”和“CP浏览量最大值”");l.isRes=!0;const t={};e.value.FVALUE.replace(/[\{\}]/,"").split(",").map(e=>e.trim()).forEach(e=>{const n=e.split(":").map(e=>e.trim().replace(/\'/g,""));t[n[0]]=+n[1]}),l.maxExposeAmount=+t[-1];const n=[],a=Object.keys(t),i=[];for(const e of a)"-1"!==e&&i.push(e);const s=i.join(",");n.push({name:"是",value:s}),l.freeOrNotCP=n,l.chargeCP=i.map(e=>+e),console.log("cache: ",l)}})}},{name:"maxExposeAmount",action:function(){return l.maxExposeAmount}},{name:"freeOrNotCP",action:function(){return l.freeOrNotCP}},{name:"sum-row",action:function(e){return e&&"sum"===e.key?"sum-row":""}},{name:"isFreeOrNotRow",action:function(e){const t=(new o).query(!0);if(!t)return"";let n=t.filter;if(!n)return"";if("string"==typeof n&&(n=JSON.parse(decodeURIComponent(n))),n.FCPID)return"";{const t=l.chargeCP,n=e.FCPID;return t.includes(n)?"green":""}}}];r.push({name:"highlightAddedDistribution",action:function(e){return 0!==e.fliterOrder?"green":""}}),r.push({name:"changeVideoStatus",action:function(){return s(this,void 0,void 0,function*(){yield this.props.dispatch({type:"fields.setValue",value:{status:2}})})}}),r.push({name:"initChannelList",action:function(){return s(this,void 0,void 0,function*(){const e=yield a.a.get(i.a.queryTable.url,{tableName:"T_CHANNEL"});if(200===e.code){const t=e.value.list||[],n=[];return l.subChannelOptions=t.map(e=>(!1===n.some(t=>t.value===e.FCHANNEL_ID)&&n.push({name:e.FNAME,value:e.FCHANNEL_ID}),{name:e.FCNAME,value:e.FID,row:e})),void(l.channelOptions=n)}throw new Error("Can not fetch channel list: "+JSON.stringify(e))})}}),r.push({name:"channelOptions",action:function(){return l.channelOptions}}),r.push({name:"subChannelOptions",action:function(){return l.subChannelOptions}}),t.a=r},"./assets/component/table/List.tsx":function(e,t,n){"use strict";var a=n("./node_modules/react/index.js"),i=n("./node_modules/react-loadable/lib/index.js"),s=n.n(i),o=n("./node_modules/antd/es/spin/index.js"),l=n("./node_modules/antd/es/table/index.js"),r=n("./node_modules/react-redux/es/index.js"),u=n("./node_modules/react-router/es/withRouter.js"),c=n("./assets/action/miscellaneous.ts"),m=n("./assets/action/buttonActions.ts"),d=n("./assets/lib/handy.ts"),p=n("./node_modules/antd/es/menu/index.js"),y=n("./node_modules/antd/es/button/index.js"),f=n("./node_modules/antd/es/tooltip/index.js"),h=n("./node_modules/antd/es/dropdown/index.js"),N=n("./node_modules/antd/es/rate/index.js"),T=n("./node_modules/react-router-dom/es/Link.js"),v=n("./assets/const/MISC.ts");const E=n("./node_modules/lc-time-format/index.js"),g=n("./node_modules/urijs/src/URI.js"),S=n("./assets/img/default.jpg");var k=function(e,t,n,i){let s,o="";if(d.a.isValuePath(i.keyName)&&(e=d.a.getValueByPath(t,i.keyName)),i.isShowRawValue)o=s=e;else if("select"===i.type){if("bit"===i.valueType){if((e=+e)<0)throw new Error("Value type is bit. The value should not negative.");e=d.a.transferIntToBitIndex(e)}if("multiple"===i.mode)o=s=e.map(e=>{const t=i.options.find(t=>t.value===e);return!!t&&t.name}).filter(e=>!1!==e).join(i.joinSymbol||",");else{const t=i.options.find(t=>"number"==typeof t.value?t.value===+e:t.value===e);t?o=s=t.name:s="-"}}else if(["update-time","create-time","date","time"].includes(i.type))s=E(new Date(e),"Y-M-D H:N:S");else if("button"===i.type){const e=i.buttonType||"link",o=[],l=[];for(const s of i.buttons){let i=!0;if(void 0!==s.isShow&&("string"==typeof s.isShow?i=s.isShow(t):s.isShow.keyName?Array.isArray(s.isShow.keyValue)?!1===s.isShow.keyValue.includes(t[s.isShow.keyName])&&(i=!1):s.isShow.keyValue!==t[s.isShow.keyName]&&(i=!1):i=!!s.isShow),s.isShow&&s.isShow.isNotEqual&&(i=!i),!i)continue;const r={className:"link"};if(r.key=s.name,r.type=s.type||e,s.actionName){const e=m.a.find(e=>e.name===s.actionName);r.onClick=e.action.bind(this,t)}if(!0===s.isDisabled&&(r.disabled=!0),s.isDropdown)l.push(a.createElement(p.a.Item,{key:s.actionName+"-"+n},s.name));else if(s.link){const e=new g(s.link.href);Object.keys(s.link.argMap).forEach(n=>{const a=s.link.argMap[n];e.setQuery(n,t[a])});const n=e.toString();o.push(a.createElement(y.a,Object.assign({},r),a.createElement(T.a,{key:s.name,to:n},s.name)))}else{const e=a.createElement(y.a,Object.assign({},r),s.name);s.tooltip?o.push(a.createElement(f.a,{key:s.name,title:s.tooltip.title},e)):o.push(e)}}if(l.length){const n=a.createElement(p.a,{onClick:this.overlayClick.bind(this,t)},l),s={};s.type=i.dropdownType||e,s.icon="ellipsis",o.push(a.createElement(h.a,{key:"dropdown-menu",trigger:["click"],overlay:n},a.createElement(y.a,Object.assign({},s))))}s=a.createElement(y.a.Group,null,o)}else"image"===i.type?e?(i.split&&(e=e.split(",")[0]),s=a.createElement("img",{src:e})):s=i.isBlank?a.createElement("img",{src:v.a}):a.createElement("img",{src:S}):"rate"===i.type?s="text"===i.listType?e:a.createElement(N.a,{disabled:!0,defaultValue:e}):o=s=e;if("string"==typeof s&&i.link){const e={target:"_blank"};if(i.link.target&&(e.target=i.link.target),i.link.query){let n=i.link.prefix,a=new g(n);i.link.query&&a.setQuery(i.link.query.key,t[i.link.query.value]),e.href=a.toString()}else i.link.keyName&&(e.href=t[i.link.keyName]);s=a.createElement("a",Object.assign({},e),s)}let l={style:{}};i.width&&("number"==typeof i.width?l.style.width=i.width+"px":l.style.width=i.width),l.className="field-value",i.hasTooltip||i.tooltip||(l.title=o),"sum"===t.key&&i.maxRed&&c.a.find(e=>e.name===i.maxRed).action()<e&&(l.className+=" max-red");if(i.click){const e=m.a.find(e=>e.name===i.click.actionName);l.onClick=e.action.bind(this,t),l.className+=" clickable"}if(s=a.createElement("span",Object.assign({},l),s),!0===i.hasTooltip||i.tooltip)if(i.tooltip){let e="";i.tooltip.title?e=i.tooltip.title:i.tooltip.keyName&&(e=t[i.tooltip.keyName]),e&&(s=a.createElement(f.a,{arrowPointAtCenter:!0,title:e},a.createElement("span",{className:"clickable"},s)))}else s=a.createElement(f.a,{arrowPointAtCenter:!0,title:o},s);return s},I=n("./assets/lib/page.ts"),C=function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,l)}r((a=a.apply(e,t||[])).next())})};const _=n("./node_modules/urijs/src/URI.js"),b=s()({loader:()=>Promise.all([n.e(3),n.e(5),n.e(36),n.e(35)]).then(n.bind(null,"./assets/component/Modal/EditFormModal.tsx")),loading:()=>a.createElement("div",null,"loading...")});const A=Object(r.b)(e=>{let t=e.table;return t.formFields=e.fields,t},e=>({setValue:(t,n)=>e({type:"table.setValue",value:n,key:t}),setEditFormValue:(t,n)=>e({type:"editForm.setValue",value:n,key:t}),dispatch:e}))(class extends a.Component{constructor(e){super(e),this.showList=[],this.primaryField={},this.pageChange=(e=>{const t=new _;t.setQuery("page",e),this.props.history.push(t.pathname()+"?"+t.query())}),this.pageSizeChange=((e,t)=>{const n=new _;n.setQuery("pageSize",t),n.setQuery("page",1),this.props.history.push(n.pathname()+"?"+n.query())}),this.tableChange=((e,t,n)=>C(this,void 0,void 0,function*(){if("fake"===this.listConfig.pager)return this.props.setValue("pageSize",e.pageSize),void this.props.setValue("page",e.current);const t=new _,a=t.query(!0);if((+a.pageSize||10)!==e.pageSize)return yield this.props.setValue("pageSize",e.pageSize),yield this.props.setValue("page",e.current),"redux"===this.props.queryType?this.freshList():(t.setQuery("page",1),t.setQuery("pageSize",e.pageSize),void this.historyPush(t));if((this.props.page||+a.page||1)!==e.current)return yield this.props.setValue("page",e.current),"redux"===this.props.queryType?this.freshList():(t.setQuery("page",e.current),void this.historyPush(t));const i=a.sortBy,s=a.sortOrder;if(i!==n.field||s!==n.order){if(!n.field)return t.removeQuery(["sortBy","sortOrder"]),void this.historyPush(t);t.setQuery("sortBy",n.field);let e="";return"descend"===n.order&&(e="DESC"),"ascend"===n.order&&(e="ASC"),t.setQuery("sortOrder",e),void this.historyPush(t)}})),this.freshList=e.freshList,I.a.onPageFinished=(()=>C(this,void 0,void 0,function*(){if(console.log("list page finished."),this.freshList&&this.freshList(),this.primaryField=this.props.fields.find(e=>!!e.isPrimaryKey),this.listConfig=this.primaryField.listConfig||{},!this.primaryField)throw new Error("Must provide primary key definition.")}))}shouldComponentUpdate(e){return this.props.isLoading!==e.isLoading||!1===I.a.isSwitching&&!1===e.isLoading}componentDidMount(){return C(this,void 0,void 0,function*(){const e=(new _).query(!0);yield this.props.setValue("pageSize",+e.pageSize||10),yield this.props.setValue("page",+e.page||1);const t=window.location.pathname,n=this.props.history.listen(()=>C(this,void 0,void 0,function*(){if(t!==window.location.pathname)return n(),void console.log("path name has been change. no freshing list follow.");const e=(new _).query(!0);e.page&&e.pageSize&&(this.props.page!==+e.page&&(yield this.props.setValue("page",+e.page)),this.props.pageSize!==+e.pageSize&&(yield this.props.setValue("pageSize",+e.pageSize))),this.freshList()}))})}fieldChange(e,t){this.props.setFieldsValue(e.keyName,t.target.value)}sort(e){return C(this,void 0,void 0,function*(){const t=this.props.sortBy,n=this.props.sortOrder,a=e.keyName;if(t)if(t===a){const e=n?"DESC"===n?"ASC":"DESC":"ASC";yield this.props.setValue("sortOrder",e)}else yield this.props.setValue("sortOrder","DESC"),yield this.props.setValue("sortBy",a);else yield this.props.setValue("sortOrder","DESC"),yield this.props.setValue("sortBy",a);this.freshList()})}historyPush(e){this.props.history.push(e.pathname()+"?"+e.query())}overlayClick(e,t){const n=t.key.split("-"),a=n[0];n[1],m.a.find(e=>e.name===a).action.call(this,e)}render(){if(I.a.isSwitching)return"";const e=(new _).query(!0),t=this.props.fields,n={},i=t.filter(e=>!0!==e.unlistable).map(t=>{let n=t.keyName||t.name;const a={title:t.name,dataIndex:n,render:(e,n,a)=>k.call(this,e,n,a,t),key:t.name||t.keyName};return t.sortable&&(a.sorter=!0),e.sortBy===t.keyName&&("ASC"===e.sortOrder?a.sortOrder="ascend":"DESC"===e.sortOrder?a.sortOrder="descend":a.sortOrder=!1),t.width&&(a.width=t.width),a}),s=this.props.list.slice();let r;!1===this.listConfig.pager?r=!1:"more"===this.listConfig.pager?r=!1:["fake",void 0].includes(this.listConfig.pager)&&(r={total:this.props.total,pageSize:this.props.pageSize,showQuickJumper:!0,current:this.props.page,showSizeChanger:!0});const u=t.filter(e=>!!e.isSum);if(u.length){const e={key:"sum"};e[t.find(e=>void 0===e.unlistable).keyName]="汇总";for(const t of s)for(const n of u)void 0===e[n.keyName]&&(e[n.keyName]=0),e[n.keyName]+=t[n.keyName]||0;s.push(e)}return n.pagination=r,n.columns=i,n.dataSource=s,n.size="middle",n.className="table-list",n.loading=this.props.isLoading,n.onChange=this.tableChange,n.rowKey=this.primaryField.keyName,n.rowClassName=this.primaryField&&this.primaryField.rowClassName?(e,t)=>c.a.find(e=>e.name===this.primaryField.rowClassName.action).action.call(this,e):"",n.bordered=!0,"more"===this.listConfig.pager&&s.length&&!0!==this.props.noMore&&(n.footer=(()=>{let e="更多";n.loading&&(e=a.createElement(o.a,null));const t={className:"more"};return t.onClick=(()=>C(this,void 0,void 0,function*(){yield this.props.setValue("page",this.props.page+1),this.freshList.call(this)})),a.createElement("div",Object.assign({},t),e)})),a.createElement("div",{className:"content-list"},a.createElement(l.a,Object.assign({},n)),a.createElement(b,{freshList:this.freshList}))}}),O=Object(u.a)(A);t.a=O},"./assets/const/API.ts":function(e,t,n){"use strict";const a="/"+n("./common/SYSTEM.js").urlVersion.value+"/api",i={tableQuery:{url:"/table/list",description:"查询mysql表数据，该接口将会失效"},queryTable:{url:"/table/query",description:"查询mysql表数据，优先使用这个",type:"all"},queryOne:{url:"/table/query-one",description:"跟queryTable差不多，但只获取一个"},removeTableRecord:{url:"/table/remove",description:"删除指定fields的数据，可以删除一个或多个"},getByKeyName:{url:"/table/getByKeyName",description:"通过keyName字段去查询表中数据"},tableDistinctQuery:{url:"/table/distinct",description:"滤重方式查询mysql的某个字段"},getOneFromTable:{url:"/table/one",description:"通过主键ID的值，从mysql表中获取单条数据"},updateTableRow:{url:"/table/upsert",description:"更新或新增mysql表中的某条数据，仅支持POST方式"},duplicateRow:{url:"/table/duplicateOne",description:"复制一条纪录到同一个表"},multiTableUpsert:{url:"/table/multi-upsert",description:"可以单次提交多个mysql表的更新或新增"},multiTableSave:{url:"/table/multi-save",description:"可以提交多个表的更新操作，包括新增、删除、更新"},reUploadImage:{url:"/common/re-upload",description:"转发上传图片到java服务器"},serverRequest:{url:"/common/redirect",description:"由于权限和跨域的原因，浏览器不能直接请求某个API，需要用这个API来帮忙请求。"},deleteOneFromTable:{url:"/table/deleteOne",description:"从 mysql 表中删除某条数据"},saveDistribution:{url:"/distribution/save",description:"保存分发运营配置"},pushUpDistribution:{url:"/distribution/pushUp",description:"置顶某条内容"},blockDistribution:{url:"/distribution/block",description:"屏蔽某条内容"},getDistributionStyle:{url:"/distribution/getStyle",description:"获取某条位置的样式"},saveDistributionStyle:{url:"/distribution/saveStyle",description:"保存某条位置的样式"},freshDistributionCache:{url:"/distribution/freshCache",description:"刷新缓存"},crawlUrl:{url:"/crawl/getContent",description:"抓取某个页面的内容，返回json数据",type:"POST"},exportData:{url:"/table/export",description:"下载SQL数据",type:"GET"},importData:{url:"/table/import",description:"上传SQL数据",type:"POST"},saveImage:{url:"/crawl/save-image",description:"保存图片到魅族服务器",type:"POST"}};Object.keys(i).forEach(e=>i[e].url=a+i[e].url),t.a=i},"./assets/const/MISC.ts":function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});const a="YYYY-MM-DD HH:mm:ss",i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},"./assets/img/default.jpg":function(e,t,n){e.exports=n.p+"assets/23dec7018c923dc139b7dad1148ff02d.jpg"},"./assets/lib/Component.ts":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n("./node_modules/react/index.js"),i=n("./assets/lib/handy.ts");class s extends a.Component{constructor(e){super(e),i.a.setTitle(e)}}},"./assets/lib/distribution.ts":function(e,t,n){"use strict";var a=n("./node_modules/antd/es/message/index.js"),i=n("./assets/const/API.ts"),s=n("./assets/lib/ajax.ts"),o=n("./assets/lib/handy.ts"),l=function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,l)}r((a=a.apply(e,t||[])).next())})};const r=n("./common/enum/ALGORITHM.js"),u=n("./node_modules/urijs/src/URI.js"),c=n("./node_modules/shortid/index.js"),m={getDefaultCondition(e){return l(this,void 0,void 0,function*(){let t=[];const n=yield s.a.get(i.a.getByKeyName.url,{dbName:"MEIZU_CONTENTS",tableName:"T_CONTENT_DIS_CONDITION",keyValue:e.FID,keyName:"FDISID"});if(Array.isArray(n.value)){t=n.value.map(e=>{0===e.FCPID&&(e.FCPID=null);const t=e.FSUB_CATEGORY;return e.FSUB_CATEGORY={value:t,options:[]},e._action="set",e._key=c.generate(),e});for(let e of t)e.FCATEGORY&&(e.FSUB_CATEGORY.options=yield this.getSubCategory(e.FCATEGORY))}return t})},getFirstCategory(){return l(this,void 0,void 0,function*(){let e=[];const t=yield s.a.get(i.a.tableDistinctQuery.url,{dbName:"MEIZU_CONTENTS",tableName:"T_CONTENT_CATEGORY",keyName:"FCATEGORY"});return 200===t.code&&Array.isArray(t.value)&&(e=t.value.map(e=>({name:e.FCATEGORY,value:e.FCATEGORY}))).push({name:"无",value:null}),e})},getSubCategory(e){return l(this,void 0,void 0,function*(){const t=yield s.a.get(i.a.getByKeyName.url,{dbName:"MEIZU_CONTENTS",tableName:"T_CONTENT_CATEGORY",keyName:"FCATEGORY",keyValue:e});if(200===t.code){if(Array.isArray(t.value)){const e=t.value.map(e=>({name:e.FSUB_CATEGORY,value:e.FSUB_CATEGORY}));return e.push({name:"无",value:null}),e}return[]}a.a.error(t.message)})},getConditions(e){return l(this,void 0,void 0,function*(){e=e||this.props.selectedAlgorithm;const t=(new u).query(!0).disId,n=yield s.a.get(i.a.getByKeyName.url,{dbName:"MEIZU_CONTENTS",tableName:"T_CONTENT_DIS_CONDITION",keyValue:t,keyName:"FDISID"});if(200===n.code){if(Array.isArray(n.value)){const o=n.value.filter(e=>!e.FALGOVER).map(e=>({category:e.FCATEGORY||null,cpId:0===e.FCPID?null:e.FCPID,subCategory:e.FSUB_CATEGORY||null,type:void 0===e.FTYPE?null:e.FTYPE,id:e.FID})),l=n.value.filter(e=>!!e.FALGOVER),u={},c={tableName:"T_CONTENT_DIS_CONDITION",rows:[]};for(const e of r){const n=e.value;if(!n)continue;const a=l.find(e=>e.FALGOVER===n);if(!a||[null,void 0,""].includes(a.FCATEGORYID)){const i=yield m.getCategory.call(this,n);if(!1===Array.isArray(i))throw new Error("Can not find categories, can not set default category id.");const s=i.find(e=>"推荐"===e.name);let o=null,l="";s&&(o=s.id,l=s.name);const r={_action:"set",FCATEGORYID:o,FDISID:t,FCATEGORY:l,FSUB_CATEGORY:"",FALGOVER:n,FCPID:e.cpId};a&&(r.FID=a.FID),c.rows.push(r)}}if(c.rows.length){const t=[c],n=yield s.a.post(i.a.multiTableSave.url,{tables:t});return 200!==n.code?void a.a.error("设置默认分类失败:"+n.message):(console.log("refresh conditions value after setting default category value."),yield m.getConditions.call(this,e))}for(const e of r){const t=e.value;if(!t)continue;const n=l.find(e=>e.FALGOVER===t);u[t]={category:n.FCATEGORYID||null,type:void 0===n.FTYPE?null:n.FTYPE,id:n.FID}}console.log("cpConditions: ",u),yield this.props.dispatch({type:"contentAlgorithm.setValue",value:{serverConditions:n.value,conditions:o,cpConditions:u}})}}else a.a.error("获取当前过滤条件错误："+n.message)})},getCategory(e){return l(this,void 0,void 0,function*(){const t=e||"noAlgorithm";if(this.props.category[t])return this.props.category[t];let n;if("noAlgorithm"===t){const e=yield s.a.post(i.a.queryTable.url,{tableName:"T_CONTENT_CATEGORY"});if(200!==e.code)return void a.a.error("获取无算法的分类失败："+e.message);const t=new Set;for(const n of e.value.list)t.add(n.FCATEGORY);this.props.dispatch({type:"contentAlgorithm.setValue",key:"firstCategory",value:[...t]}),n=e.value.list}else{const t=new u("http://om.iflow.meizu.com/service/dis/condition");t.setQuery("algover",e);const o=yield s.a.get(i.a.serverRequest.url,{url:t.toString()});if(200!==o.code)return void a.a.error("获取分类列表失败："+o.message);n=o.value.categories.map(e=>(e.id=(e.id||"")+"",e))}const l=o.a.copyObj(this.props.category);return l[t]=n,yield this.props.dispatch({type:"contentAlgorithm.setValue",key:"category",value:l}),l[t]})},freshCache(e){return l(this,void 0,void 0,function*(){let t=yield s.a.post(i.a.freshDistributionCache.url,{disId:e});200===t.code?a.a.success("刷新成功"):a.a.error(t.message)})}};t.a=m},"./assets/lib/page.ts":function(e,t,n){"use strict";var a=n("./assets/reducer/index.ts"),i=n("./assets/action/miscellaneous.ts"),s=function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function o(e){try{r(a.next(e))}catch(e){s(e)}}function l(e){try{r(a.throw(e))}catch(e){s(e)}}function r(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,l)}r((a=a.apply(e,t||[])).next())})};const o=n("./common/filter/index.js"),l=(n("./node_modules/shortid/index.js"),n("./node_modules/urijs/src/URI.js")),r={isSwitching:!1,initFieldOptions(e){for(const t of e)if("string"==typeof t.options){const e=i.a.find(e=>e.name===t.options);t.options=e.action()}},setPageConfig:function(e){return s(this,void 0,void 0,function*(){if(this.isSwitching=!0,yield a.default.dispatch({type:"table.setValue",value:{isLoading:!0}}),e.init)for(const t of e.init){yield i.a.find(e=>e.name===t).action()}const t=(new l).query(!0),n=e.dbName||"MEIZU_CONTENTS",s=e.tableName||"",u=e.fields||[],c=e.isAbleAddItem||!1,m=e.listUrl||"",d=e.editModalWidth||720,p=e.queryType||"url";let y=e.queryFields;this.initFieldOptions(u),yield a.default.dispatch({type:"table.setValue",value:{dbName:n,tableName:s,fields:u,isAbleAddItem:c,list:[],listUrl:m}});let f=t.filter;if("string"==typeof f?f=JSON.parse(decodeURIComponent(f)):f||(f={}),y||(s?y=o[s]:console.log("no filter defined.")),y){y=JSON.parse(JSON.stringify(y)),this.initFieldOptions(y);const e=Object.keys(f);for(const t of y){const n=t.keyName;if(n)if(e.includes(n))t.value=f[n];else if(void 0!==t.defaultValue&&(t.value=t.defaultValue,"select"===t.type)){if(t.options.find(e=>e.value===t.defaultValue));else if("number"==typeof t.defaultValue)t.value=t.options[t.defaultValue].value;else if(!0===Array.isArray(t.defaultValue));else if(null!==t.defaultValue)throw console.log("filter field: ",t),new Error("can not recognize this default value.")}}}else y=[];yield a.default.dispatch({type:"table.setValue",value:{queryType:p,queryFields:y,editModalWidth:d}}),r.onPageFinished(),this.isSwitching=!1})},onPageFinished:function(){console.log("page finished.")}};t.a=r},"./assets/page/CPList.tsx":function(e,t,n){"use strict";n.r(t);var a=n("./node_modules/react/index.js"),i=n("./node_modules/react-redux/es/index.js"),s=n("./assets/lib/page.ts"),o=n("./assets/component/table/List.tsx"),l=n("./assets/lib/Component.ts"),r=n("./assets/action/freshTableList.ts");const u=n("./common/db/T_CP.js");const c=Object(i.b)(function(e){return e.table})(class extends l.a{constructor(e){super(e),s.a.setPageConfig({fields:u,isAbleAddItem:!0,tableName:"T_CP"})}render(){return a.createElement("div",{id:"cp-list"},a.createElement(o.a,{freshList:r.a}))}});t.default=c},"./common/db/T_CP.js":function(e,t){e.exports=[{name:"CP ID",keyName:"FID",isPrimaryKey:!0,readonly:!0,isAutoGen:!0},{name:"CP名称",keyName:"FCPNAME"},{name:"CP英文简称",keyName:"FENNAME",unlistable:!0},{name:"内容源URL",keyName:"FURL",unlistable:!0},{name:"内容源图标",keyName:"FICO_URL",unlistable:!0},{name:"入库类型",keyName:"FCONTENT_OBTAIN_TYPE",type:"select",valueType:"bit",mode:"multiple",joinSymbol:"+",options:[{name:"个性化算法",value:0},{name:"搜索下发",value:1},{name:"内容同步",value:2},{name:"爬虫入库",value:3}]},{name:"新闻内容正则表达式",keyName:"FEXPRESSIONS",unlistable:!0},{name:"备注",keyName:"FDESCRIPTION"},{name:"状态",keyName:"FSTATUS",type:"select",options:[{name:"已下架",value:0},{name:"已上架",value:1}]},{name:"源内容类型",keyName:"FTYPE",unlistable:!0},{name:"发布方式",keyName:"FAUTOMATIC_CAPTURE",type:"select",options:[{name:"手动发布",value:0},{name:"自动发布",value:1}],unlistable:!0},{name:"源星级",keyName:"FLEVEL",unlistable:!0},{name:"接口类路径",keyName:"FCLASS_PATH",unlistable:!0},{name:"CP支持的业务",keyName:"FSUPPORT_BIZ",valueType:"bit",mode:"multiple",type:"select",options:[{name:"全部",value:0},{name:"资讯",value:1},{name:"浏览器",value:2},{name:"趣视频",value:3}],unlistable:!0},{name:"入库类型",keyName:"FINSERT_TYPE",valueType:"bit",mode:"multiple",type:"select",options:[{name:"CP库",value:0},{name:"内容库",value:1},{name:"作者库",value:2}],unlistable:!0},{name:"更新时间",keyName:"FUPDATE_TIME",type:"update-time",unlistable:!0},{name:"创新时间",keyName:"FCREATE_TIME",type:"create-time",unlistable:!0},{name:"操作",type:"button",buttons:[{name:"下架",actionName:"offlineCP",isShow:{keyName:"FSTATUS",keyValue:1}},{name:"上架",actionName:"onlineCP",isShow:{keyName:"FSTATUS",keyValue:0}}]}]},"./common/enum/ALGORITHM.js":function(e,t){e.exports=[{value:"",name:"无算法"},{value:"uc_algover",name:"UC",categoryName:"UC分类",cpId:2,noContentType:!0},{value:"baidu_algover",name:"百度",categoryName:"百度分类",cpId:76},{value:"jrtt_algover",name:"今日头条",categoryName:"头条分类",cpId:200},{value:"yidian_algover",name:"一点资讯",categoryName:"一点资讯分类",cpId:81,noContentType:!0}]},"./common/enum/ANALYSIS_RULE_STATUS.js":function(e,t){e.exports=[{name:"未验证",value:1},{name:"验证中",value:2},{name:"验证成功",value:3}]},"./common/enum/CONTENT_SOURCES.js":function(e,t){e.exports=[{name:"今日头条",value:1},{name:"网易",value:2},{name:"凤凰新闻(爬)",value:3},{name:"界面新闻",value:4},{name:"搜狐新闻",value:5},{name:"网易有料",value:6}]},"./common/enum/CONTENT_STATUS.js":function(e,t){e.exports=[{name:"上架",value:1},{name:"下架",value:0},{name:"删除",value:3},{name:"敏感",value:7}]},"./common/enum/CONTENT_TYPES.js":function(e,t){e.exports=[{name:"文章",value:0},{name:"图集",value:2},{name:"视频",value:11}]},"./common/enum/CP_SOURCES.js":function(e,t){e.exports=[{value:1,name:"LOFTER",keyName:"LOFTER",hideWhenEdit:!0},{value:2,name:"UC",keyName:"UC",hideWhenEdit:!0},{value:4,name:"魅族资讯",keyName:"MEIZU"},{value:8,name:"新浪",keyName:"SINA",hideWhenEdit:!0},{value:16,name:"魅族视频",keyName:"FLYME_VIDEO",hideWhenEdit:!0},{value:32,name:"魅族推荐",keyName:"MEIZU_RECOMMEND",hideWhenEdit:!0},{value:64,name:"腾讯新闻",keyName:"TENCENT",hideWhenEdit:!0},{value:65,name:"360视频",keyName:"RES_360",hideWhenEdit:!0},{value:66,name:"腾讯浏览器",keyName:"QQ_BROWSER",hideWhenEdit:!0},{value:67,name:"橘子娱乐",keyName:"JUZI",hideWhenEdit:!0},{value:68,name:"360搜索",keyName:"SEARCH_360",hideWhenEdit:!0},{value:69,name:"腾讯快报",keyName:"KB",hideWhenEdit:!0},{value:70,name:"360文章",keyName:"APP_360",hideWhenEdit:!0},{value:71,name:"UC视频",keyName:"UC_VIDEO",hideWhenEdit:!0},{value:72,name:"快手视频",keyName:"KS_VIDEO",hideWhenEdit:!0},{value:73,name:"轻芒阅读",keyName:"QINGMANG",hideWhenEdit:!0},{value:74,name:"优品",keyName:"YOUPIN"},{value:75,name:"英威诺",keyName:"INVENO",hideWhenEdit:!0},{value:76,name:"百度",keyName:"BAIDU",hideWhenEdit:!0},{value:77,name:"百度视频",keyName:"BAIDU_VIDEO",hideWhenEdit:!0},{value:78,name:"凤凰新闻",keyName:"IFENG_MEIZU",hideWhenEdit:!0},{value:79,name:"网易有料",keyName:"163_NEWS",hideWhenEdit:!0},{value:80,name:"腾讯语音",keyName:"TENCENT_VOICE",hideWhenEdit:!0},{value:81,name:"一点资讯",keyName:"YIDIAN",hideWhenEdit:!0},{value:82,name:"唯彩看球",keyName:"VIPC",hideWhenEdit:!0},{value:83,name:"唔哩头条",keyName:"WULI",hideWhenEdit:!0},{value:84,name:"今日头条",hideWhenEdit:!0,keyName:"JINRITOUTIAO"},{value:85,name:"西瓜视频",hideWhenEdit:!0,keyName:"TOUTIAO_XIGUA"},{value:101,name:"里世界",keyName:"LISHIJIE",hideWhenEdit:!0},{value:102,name:"好兔视频",keyName:"HAOTU",hideWhenEdit:!0}]},"./common/enum/RULE_SCRIPT_TYPES.js":function(e,t){e.exports=[{value:1,name:"模板"},{value:2,name:"内置脚本"},{value:3,name:"外置脚本"},{value:4,name:"联接脚本"}]},"./common/enum/VIDEO_CP_SOURCES.js":function(e,t){e.exports=[{name:"西瓜视频",value:200}]},"./common/filter sync \\/[A-Z_]*\\.js$":function(e,t,n){var a={"./ANALYSIS_RULE.js":"./common/filter/ANALYSIS_RULE.js","./ANALYSIS_SCRIPT.js":"./common/filter/ANALYSIS_SCRIPT.js","./AUTH_USER.js":"./common/filter/AUTH_USER.js","./CHANNEL_DISTRIBUTION.js":"./common/filter/CHANNEL_DISTRIBUTION.js","./CONTENT_FILTER.js":"./common/filter/CONTENT_FILTER.js","./CP_API_LIST.js":"./common/filter/CP_API_LIST.js","./CP_LIST.js":"./common/filter/CP_LIST.js","./GRAB_RULES.js":"./common/filter/GRAB_RULES.js","./SETTING_PARAM.js":"./common/filter/SETTING_PARAM.js","./SPECIAL_ARTICLES.js":"./common/filter/SPECIAL_ARTICLES.js","./T_AUTHOR.js":"./common/filter/T_AUTHOR.js","./T_CHANNEL.js":"./common/filter/T_CHANNEL.js","./T_CONTENTS.js":"./common/filter/T_CONTENTS.js","./T_CONTENT_DIS.js":"./common/filter/T_CONTENT_DIS.js","./T_CONTENT_DIS_DISPLAY.js":"./common/filter/T_CONTENT_DIS_DISPLAY.js","./T_CONTENT_VIEW_STATUS.js":"./common/filter/T_CONTENT_VIEW_STATUS.js","./T_CONTENT_VIEW_SUMMARY.js":"./common/filter/T_CONTENT_VIEW_SUMMARY.js","./T_CP.js":"./common/filter/T_CP.js","./T_CRAWL_RULE.js":"./common/filter/T_CRAWL_RULE.js","./T_FUNCTION.js":"./common/filter/T_FUNCTION.js","./T_FUNCTION_RULE.js":"./common/filter/T_FUNCTION_RULE.js","./VIDEO.js":"./common/filter/VIDEO.js"};function i(e){var t=s(e);return n(t)}function s(e){var t=a[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}i.keys=function(){return Object.keys(a)},i.resolve=s,e.exports=i,i.id="./common/filter sync \\/[A-Z_]*\\.js$"},"./common/filter/ANALYSIS_RULE.js":function(e,t,n){const a=n("./common/enum/ANALYSIS_RULE_STATUS.js");e.exports=[{name:"序号",keyName:"id"},{name:"表达式",keyName:"regexp"},{name:"状态",keyName:"status",type:"select",options:a}]},"./common/filter/ANALYSIS_SCRIPT.js":function(e,t,n){const a=n("./common/enum/RULE_SCRIPT_TYPES.js");e.exports=[{name:"序号",keyName:"id"},{name:"名称",keyName:"name"},{name:"类型",keyName:"type",type:"select",options:a}]},"./common/filter/AUTH_USER.js":function(e,t){e.exports=[{name:"用户名称",keyName:"name"},{name:"备注",keyName:"remark"}]},"./common/filter/CHANNEL_DISTRIBUTION.js":function(e,t){e.exports=[{name:"分发渠道",type:"select",keyName:"FCHANNEL_ID"},{name:"新旧分发",keyName:"FFLAG",defaultValue:1,isShow:!1}]},"./common/filter/CONTENT_FILTER.js":function(e,t,n){const a=n("./common/enum/CP_SOURCES.js"),i=n("./common/enum/CONTENT_TYPES.js"),s=n("./common/enum/CONTENT_SOURCES.js"),o=n("./common/enum/CONTENT_STATUS.js");e.exports=[{name:"文章ID",keyName:"id"},{name:"CP文章ID",keyName:"uniqueId"},{name:"文章标题",keyName:"title"},{name:"作者",keyName:"author"},{name:"类型",keyName:"category"},{name:"标签",keyName:"label"},{name:"关键字",keyName:"keywords"},{name:"内容CP",keyName:"resourceTypes",type:"select",options:a,mode:"multiple",defaultValue:[null]},{name:"内容源",keyName:"contentSourceIdParam",type:"select",options:s,isShow:{type:"condition",keyName:"resourceTypes",value:4}},{name:"内容类型",type:"select",keyName:"type",options:i,defaultValue:null},{name:"状态",keyName:"status",type:"select",options:o,defaultValue:1},{name:"时间范围",keyName:"scope",type:"select",defaultValue:1,options:[{name:"1日",value:1},{name:"3日",value:3},{name:"7日",value:7},{name:"15日",value:15},{name:"30日",value:30},{name:"自定义",value:-1}]},{name:"时间",keyName:"scopeRange",keyNames:["customScope_start","customScope_end"],type:"dateRange",isShow:{type:"condition",value:-1,keyName:"scope",isRequired:!0}},{name:"排序",keyName:"order",type:"select",defaultValue:null,options:[{name:"浏览量",value:"viewCount"},{name:"上架时间",value:"putdate"},{name:"转化率",value:"conversionV1"}]},{keyName:"add-360-video",type:"button",name:"添加视频",actionName:"openVideoInput"},{keyName:"baidu-content-input",type:"button",name:"百度入库",link:{href:"/v2/page/content-manage/baidu-content-input"}}]},"./common/filter/CP_API_LIST.js":function(e,t){e.exports=[{keyName:"id",name:"ID"},{keyName:"newGrabApi",name:"新增",actionName:"newGrabApi",type:"button"}]},"./common/filter/CP_LIST.js":function(e,t){e.exports=[{keyName:"cpId",name:"CP ID"},{keyName:"cp",name:"CP 名称"}]},"./common/filter/GRAB_RULES.js":function(e,t,n){n("./common/enum/CP_SOURCES.js"),n("./common/enum/CONTENT_TYPES.js"),n("./common/enum/CONTENT_SOURCES.js"),n("./common/enum/CONTENT_STATUS.js");e.exports=[{name:"ID",keyName:"id"}]},"./common/filter/SETTING_PARAM.js":function(e,t,n){n("./common/enum/ANALYSIS_RULE_STATUS.js");e.exports=[{name:"类型",keyName:"type"},{name:"键",keyName:"key"},{name:"名称",keyName:"name"}]},"./common/filter/SPECIAL_ARTICLES.js":function(e,t,n){const a=n("./common/enum/CP_SOURCES.js"),i=n("./common/enum/CONTENT_TYPES.js"),s=n("./common/enum/CONTENT_SOURCES.js"),o=n("./common/enum/CONTENT_STATUS.js");e.exports=[{name:"文章ID",keyName:"id"},{name:"CP文章ID",keyName:"uniqueId"},{name:"文章标题",keyName:"title"},{name:"作者",keyName:"author"},{name:"类型",keyName:"category"},{name:"标签",keyName:"label"},{name:"关键字",keyName:"keywords"},{name:"内容CP",keyName:"resourceTypes",type:"select",options:a,mode:"multiple",defaultValue:[null]},{name:"内容源",keyName:"contentSourceIdParam",type:"select",options:s,isShow:{type:"condition",keyName:"resourceTypes",value:4}},{name:"内容类型",type:"select",keyName:"type",options:i,defaultValue:null},{name:"状态",keyName:"status",type:"select",options:o,defaultValue:1},{name:"时间范围",keyName:"scope",type:"select",defaultValue:null,options:[{name:"1日",value:1},{name:"3日",value:3},{name:"7日",value:7},{name:"15日",value:15},{name:"30日",value:30},{name:"自定义",value:-1}]},{name:"时间",keyName:"scopeRange",keyNames:["customScope_start","customScope_end"],type:"dateRange",isShow:{type:"condition",value:-1,keyName:"scope",isRequired:!0}}]},"./common/filter/T_AUTHOR.js":function(e,t){e.exports=[{name:"作者ID",type:"text",keyName:"FID"},{name:"名称",type:"text",keyName:"FNAME",searchMode:"LIKE"},{name:"分类",keyName:"FCATEGORY"},{name:"渠道",type:"select",keyName:"FSUPPORT_BIZ",tableName:"T_CP",searchMode:"bitwise",options:[{value:1,name:"资讯"},{value:2,name:"浏览器"},{value:3,name:"趣视频"},{value:4,name:"钱包"}]},{name:"作者详情",type:"select",keyName:"FOPEN_TYPE",tooltip:"客户端的作者详情页面打开方式"},{name:"内容类型",type:"select",keyName:"FCONTENT_SIGN"},{name:"星级",keyName:"FRECOMMEND_STAR",type:"rate",defaultValue:5}]},"./common/filter/T_CHANNEL.js":function(e,t){e.exports=[]},"./common/filter/T_CONTENTS.js":function(e,t){e.exports=[{name:"内容标题",type:"text",keyName:"FTITLE",searchMode:"LIKE"},{name:"内容ID",type:"text",keyName:"FCONTENT_ID"}]},"./common/filter/T_CONTENT_DIS.js":function(e,t){e.exports=[{name:"分发渠道",type:"select",keyName:"FCHANNEL_ID"}]},"./common/filter/T_CONTENT_DIS_DISPLAY.js":function(e,t){e.exports=[{keyName:"FID",isPrimaryKey:!0},{keyName:"FCONTENT_ID"}]},"./common/filter/T_CONTENT_VIEW_STATUS.js":function(e,t){const n=new Date,a=n.getFullYear()+"";let i=n.getMonth()+1;i<10?i="0"+i:i+="",e.exports=[{keyName:"FSTAT_DATE",name:"统计月份",type:"month-select",duration:{start:-6,end:0,min:"201801"},defaultValue:a+i},{keyName:"FCPID",name:"是否收费来源",type:"select",options:"freeOrNotCP",defaultValue:0,searchMode:"IN",status:"hide"}]},"./common/filter/T_CONTENT_VIEW_SUMMARY.js":function(e,t){const n=new Date,a=n.getFullYear()+"";let i=n.getMonth()+1;i<10?i="0"+i:i+="",e.exports=[{keyName:"FSTAT_DATE",name:"统计月份",type:"month-select",duration:{start:-6,end:0,min:"201801"},defaultValue:a+i},{keyName:"BIZ_TYPE",name:"业务类型",type:"select"},{keyName:"FCPID",name:"是否收费来源",type:"select",options:"freeOrNotCP",defaultValue:0,searchMode:"IN"},{name:"导出CSV",type:"button",icon:"file-excel",actionName:"downloadCSV"}]},"./common/filter/T_CP.js":function(e,t){e.exports=[{name:"来源id",keyName:"FID"}]},"./common/filter/T_CRAWL_RULE.js":function(e,t){e.exports=[{name:"规则ID",type:"text",keyName:"FID"},{name:"网站名称",type:"text",keyName:"FSITE_NAME",searchMode:"LIKE"},{name:"调试",type:"button",icon:"code-o",actionName:"openCrawlTester"},{name:"导入",type:"button",icon:"download",actionName:"import"},{name:"导出",type:"button",icon:"upload",actionName:"export"}]},"./common/filter/T_FUNCTION.js":function(e,t){e.exports=[{name:"转码ID",keyName:"FID"},{name:"方法名称",keyName:"FFUNCTION"},{name:"导入",type:"button",icon:"download",actionName:"import",args:{tableName:"T_FUNCTION_RULE"}},{name:"导出",type:"button",icon:"upload",actionName:"export",args:{tableName:"T_FUNCTION_RULE"}}]},"./common/filter/T_FUNCTION_RULE.js":function(e,t){e.exports=[{name:"规则ID",keyName:"FID"},{name:"JS方法名",keyName:"FMETHOD"}]},"./common/filter/VIDEO.js":function(e,t,n){n("./common/enum/CP_SOURCES.js"),n("./common/enum/CONTENT_STATUS.js");const a=n("./common/enum/VIDEO_CP_SOURCES.js");e.exports=[{name:"内容平台ID",keyName:"id"},{name:"CP内容ID",keyName:"cpEntityId"},{name:"标题",keyName:"title"},{name:"作者",keyName:"author"},{name:"分类",keyName:"category"},{name:"关键字",keyName:"keywords",placeholder:"多个以英文逗号隔开"},{name:"内容来源",keyName:"cpId",type:"select",options:a,defaultValue:[200],mode:"multiple",status:"hide"},{name:"状态",keyName:"status",type:"select",options:[{name:"上架",value:1},{name:"下架",value:2}],defaultValue:1},{name:"发布时间",keyName:"publishTime",type:"date",placeholder:"选择开始时间至今",sendFormat:"M/D/YYYY",notSendIfEmpty:!0}]},"./common/filter/index.js":function(e,t,n){const a=n("./common/filter sync \\/[A-Z_]*\\.js$");let i={};a.keys().forEach(e=>{if(/index\.js/.test(e))return;let t=e.match(/[\/]([^\/]+)\.js$/)[1];i[t]=a(e)}),e.exports=i}}]);
//# sourceMappingURL=28.bundle.js.map