(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"./assets/action/buttonActions.ts":function(e,t,n){"use strict";var s=n("./assets/lib/ajax.ts"),i=n("./assets/const/API.ts"),a=n("./node_modules/antd/es/message/index.js"),o=n("./assets/lib/handy.ts"),r=n("./node_modules/braft-editor/dist/index.js"),l=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};const u=n("./node_modules/urijs/src/URI.js"),c=n("./node_modules/shortid/index.js");var m=n("./assets/action/freshTableList.ts"),d=n("./common/SYSTEM.js"),p=n.n(d),y=n("./assets/action/informServer.ts"),f=n("./node_modules/antd/es/modal/index.js"),h=n("./assets/reducer/index.ts"),N=n("./assets/const/SITE_INFO.ts"),v=n("./assets/lib/distribution.ts"),T=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};const g=n("./node_modules/shortid/index.js"),E=n("./node_modules/lc-ajax/index.js"),I=n("./node_modules/urijs/src/URI.js"),S="/"+p.a.urlVersion.value,k=[];k.push({name:"toggleContentEditModal",action:function(e){return T(this,void 0,void 0,function*(){const t=this.props.fields.find(e=>e.isPrimaryKey).keyName,n=e[t];let m,d;n?(yield this.props.dispatch({type:"table.setValue",key:"editingId",value:n}),function(e,t){l(this,void 0,void 0,function*(){console.log("record: ",t);const n=e.dispatch;if(!e.editingId)return;const l=e.fields.find(e=>e.isPrimaryKey).detailConfig;let m=i.a.getOneFromTable.url;l&&l.api&&(m=l.api);const d=new u(m);if(l){const e=l.argMap;Object.keys(e).forEach(n=>{const s=e[n];console.log("key: ",n),d.setQuery(n,t[s])})}else d.setQuery("tableName",e.tableName),d.setQuery("dbName",e.dbName),d.setQuery("keyName",e.dbName),d.setQuery("keyValue",e.editingId);let p=e.fields;p.forEach(e=>{e.keyName&&("wysiwyg"===e.type?n({type:"fields.setValue",value:r.EditorState.createFrom(),key:e.keyName}):n({type:"fields.setValue",value:null,key:e.keyName}))});const y=d.toString();let f;if(l&&l.isRedirect){const e=new u(i.a.serverRequest.url);e.setQuery("url",y),f=yield s.a.get(e.toString())}else f=yield s.a.get(y);if(200!==f.code)return void a.a.error("获取内容失败");let h=f.value;h?(p.forEach(e=>{const t=e.keyName;let s;if(s=o.a.isValuePath(e.keyName)?o.a.getValueByPath(h,e.keyName):h[t],t)if(["image","images","file"].includes(e.type)){if(!s)return;if("string"==typeof s)s=[s];else if(!Array.isArray(s))throw new Error("Can not normalize this value of file.");const i=s.map(t=>{const n=new u(t),s=c.generate();return{uid:s,url:t,name:"file"===e.type?n.filename():s,status:"done"}});n({type:"fields.setValue",value:i,key:t})}else if("wysiwyg"===e.type){const e=document.createElement("template");e.innerHTML=s;const i=e.content.querySelectorAll("img");[].forEach.call(i,function(e){if(!e.src){const t=e.getAttribute("data-src");t&&e.setAttribute("src",t)}}),s=e.innerHTML,n({type:"fields.setValue",value:r.EditorState.createFrom(s),key:t})}else n({type:"fields.setValue",value:s,key:t})}),n({type:"table.setValue",value:h,key:"originalFields"}),n({type:"table.setValue",value:e.fields,key:"fields"})):a.a.error("接口返回空的内容")})}(this.props,e),m="编辑",d=!0):(console.log("add new content"),this.props.fields.forEach(e=>{if(void 0!==e.defaultValue)e.keyName&&h.default.dispatch({type:"fields.setValue",value:e.defaultValue,key:e.keyName});else if(e.source){const t=e.source,n=(new I).query(!0);let s;if("url"!==t.from)throw new Error("This is not a valid source property, please check document.");s=t.keyName?n[t.keyName]:n[e.keyName],console.log("source value: ",s),h.default.dispatch({type:"fields.setValue",value:s,key:e.keyName})}else h.default.dispatch({type:"fields.setValue",value:void 0,key:e.keyName})}),m="新建",d=!1),this.props.dispatch({type:"modal.toggle",modalName:"contentEditModal",options:{modalTitle:m,isEditing:d}}),this.props.dispatch({type:"table.setValue",value:{isEdited:!1}})})}}),k.push({name:"deleteItem",action:function(e){return T(this,void 0,void 0,function*(){const t=this.props.fields.find(e=>!!e.isPrimaryKey),n=t.deleteConfig||{},o=n&&n.deleteText||"删除后不能恢复，确定？";if(!1===window.confirm(o))return;let r=i.a.deleteOneFromTable.url;n.api&&(r=n.api);const l={};n.argMap?Object.keys(n.argMap).forEach(t=>{const s=n.argMap[t];let i="";if("string"==typeof s?i=s:(i=s.keyName,"string"===s.type&&(e[i]=e[i]+"")),n.method&&"GET"===n.method.toUpperCase()){const n=new I(r);n.setQuery(t,e[i]),r=n.toString()}else l[t]=e[i]}):(l.dbName=this.props.dbName,l.tableName=this.props.tableName,l.keyValue=e[t.keyName]);let u=E.post;if(n.method&&"GET"===n.method.toUpperCase()&&(u=s.a.get),n.isRedirect){const e=new I(i.a.serverRequest.url);e.setQuery("url",r),r=e.toString()}let c="json";"URLENCODED"===n.enctype&&(c="URLENCODED");const m=yield u(r,l,{},c);200===m.code?(a.a.success("删除成功"),setTimeout(()=>this.freshList(),1),y.a.call(this)):a.a.error("删除失败："+m.message)})}}),k.push({name:"manageItem",action:function(e){return T(this,void 0,void 0,function*(){const t=this.props.fields.find(e=>!!e.isPrimaryKey),n=e[t.keyName];this.props.history.push(S+"/page/distribution/channel/distribution-manage?keyValue="+encodeURIComponent(n))})}}),k.push({name:"blockItemFromDis",action:function(e){return T(this,void 0,void 0,function*(){yield s.a.post(i.a.blockDistribution.url,{item:e});const t=new I;t.setQuery("page",1),yield this.props.setValue("page",1),this.props.history.push(t.pathname()+t.search())})}}),k.push({name:"pushUpItemFromDis",action:function(e){return T(this,void 0,void 0,function*(){const t=yield s.a.post(i.a.pushUpDistribution.url,{item:e});if(200===t.code){const e=new I;yield this.props.setValue("page",1),e.setQuery("page",1),this.props.history.push(e.pathname()+e.search())}else a.a.error(t.message)})}}),k.push({name:"deleteItemFromDis",action:function(e){return T(this,void 0,void 0,function*(){const t=yield s.a.post(i.a.removeTableRecord.url,{tableName:"T_CONTENT_DIS_FLITER",fields:{FDISID:e.disId,FCONTENT_ID:e.id}});if(200===t.code){const e=new I;e.setQuery("page",1),this.props.history.push(e.pathname()+e.search())}else a.a.error(t.message)})}}),k.push({name:"pullDownFromDis",action:function(e){return T(this,void 0,void 0,function*(){const t=yield s.a.post(i.a.updateTableRow.url,{tableName:"T_CONTENT_DIS_FLITER",fields:{FCONTENT_ID:e.id,FORDER:1}});if(200===t.code){const e=new I;e.setQuery("page",1),this.props.history.push(e.pathname()+e.search())}else a.a.error(t.message)})}}),k.push({name:"setItemStyleFromDis",action:function(e){return T(this,void 0,void 0,function*(){this.props.dispatch({type:"disManage.setValue",key:"isEditDisplayModalOpen",value:!0});const t=yield s.a.post(i.a.queryOne.url,{tableName:"T_CONTENT_DIS_DISPLAY",fields:{FCONTENT_ID:e.id}});if(200===t.code){const n=t.value;n.FID||(n.FDISID=e.disId,n.FCONTENT_ID=e.id,n.FDISPLAY_STYLE=e.displayStyle,n.FOPEN_TYPE=e.openType,n.FOPEN_URL=e.openUrl),delete n.FPOSITION,delete n.FUPDATE_TIME,delete n.FCREATE_TIME,this.props.dispatch({type:"disManage.setValue",key:"editingStyle",value:n})}})}}),k.push({name:"openCrawlTester",action:function(){this.props.dispatch({type:"modal.toggle",key:"crawlTest",isOpen:!0,options:{}})}}),k.push({name:"openVideoInput",action:function(){return T(this,void 0,void 0,function*(){yield h.default.dispatch({type:"videoInput.setValue",key:"isOpen",value:!0})})}}),k.push({name:"import",action:function({tableName:e}){return T(this,void 0,void 0,function*(){e=e||this.props.tableName;let t=document.getElementById("import-data");t||((t=document.createElement("input")).setAttribute("id","import-data"),t.setAttribute("type","file"),t.setAttribute("accept",".json"),t.style.display="none",document.body.appendChild(t)),t.onchange=(()=>{const n=t.files;if(n.length){const s=n[0],o=new FormData;o.append("data.json",s),o.append("tableName",e);const r=new XMLHttpRequest;r.open("POST",i.a.importData.url),r.onload=(()=>{t.value="";const e=JSON.parse(r.responseText);200===e.code?(a.a.success("上传成功."),m.a.call(this)):a.a.error(e.message)}),r.send(o)}console.log(n)}),t.click()})}}),k.push({name:"export",action:function({tableName:e}){return T(this,void 0,void 0,function*(){e=e||this.props.tableName;const t=new I(i.a.exportData.url);t.origin(window.location.origin),t.setQuery("tableName",e),window.location.assign(t.toString())})}}),k.push({name:"makeUrl",action:function(e){return T(this,void 0,void 0,function*(){yield h.default.dispatch({type:"modal.toggle",key:"makeUrl",isOpen:!0,options:e})})}}),k.push({name:"makeScheme",action:function(e){return T(this,void 0,void 0,function*(){yield h.default.dispatch({type:"modal.toggle",key:"makeScheme",isOpen:!0,options:e})})}}),k.push({name:"distribute",action:function(e){return T(this,void 0,void 0,function*(){yield h.default.dispatch({type:"modal.toggle",key:"distribute",isOpen:!0,options:e})})}});const C=function(e,t){return T(this,void 0,void 0,function*(){const n=new I(t);n.setQuery("id",e.id);const o=new I(i.a.serverRequest.url);o.setQuery("url",n.toString());const r=yield s.a.get(o.toString());200===r.code?(a.a.success("操作成功！"),this.freshList()):a.a.error(r.message)})};function _({status:e,contentId:t,cpId:n,cpEntityId:o}){return T(this,void 0,void 0,function*(){const r=new I("http://om.iflow.meizu.com/service/biz/contents/status");r.setQuery("status",e),r.setQuery("contentId",t),r.setQuery("cpEntityId",o),r.setQuery("cpId",n);const l=new I(i.a.serverRequest.url);l.setQuery("url",r.toString());const u=yield s.a.get(l.toString());200===u.code?(a.a.success("操作成功"),this.freshList()):a.a.error(u.message)})}k.push({name:"deleteSpecialContent",action:function(e){C.call(this,e,N.a.domain+"/service/article/special/del")}}),k.push({name:"offShelf",action:function(e){C.call(this,e,N.a.domain+"/service/article/notrelease")}}),k.push({name:"onShelf",action:function(e){return T(this,void 0,void 0,function*(){C.call(this,e,N.a.domain+"/service/article/release")})}}),k.push({name:"filter",action:function(e){return T(this,void 0,void 0,function*(){C.call(this,e,N.a.domain+"/service/article/special/add")})}}),k.push({name:"manageFunctionRule",action:function(e){return T(this,void 0,void 0,function*(){const t=this.props.fields.find(e=>e.isPrimaryKey);this.props.history.push(S+"/page/analysis/transfer/rule-manage?FFUNCTION_ID="+encodeURIComponent(e[t.keyName]))})}}),k.push({name:"stopDistribute",action:function(e){return T(this,void 0,void 0,function*(){console.log("item: ",e),f.a.confirm({title:"提示",content:"暂停下发后，此 CP 的内容即时停止下发，下个自然月开始自动启动下发",onOk:()=>T(this,void 0,void 0,function*(){const t=new I(i.a.serverRequest.url);t.setQuery("url","https://sge.meizu.com/msr/cpgroup/offline");const n=yield E.post(t.toString(),{cps:e.FCPID},{},"URLENCODED");if(200===n.code){200===(yield s.a.post(i.a.updateTableRow.url,{tableName:"T_CONTENT_VIEW_STATUS",fields:{FCPID:e.FCPID,FSTAT_DATE:e.FSTAT_DATE,FSTATUS:4}})).code?(a.a.success("操作成功"),m.a.call(this)):a.a.error("推荐平台操作成功，状态写入失败")}else-100===n.code?f.a.confirm({title:"",content:"无法获取当前账户的UAC信息或当前账户权限不足，请点击确定跳转到“通用权限平台”登录，查看“系统功能权限->cp下线”是否已授权，如已授权则返回当前页面，刷新后操作。",onOk:()=>{window.open("https://sct.meizu.com/?ssCode=sge","_blank")}}):a.a.error(n.message)})})})}}),k.push({name:"downloadCSV",action:function(){return T(this,void 0,void 0,function*(){m.a.call(this,{exposeType:"csv"})})}}),k.push({name:"searchAuthor",action:function(e){const t=e.FNAME;this.props.history.push("/v2/page/content-manage/article?author="+t)}}),k.push({name:"visitContent",action:function(e){return T(this,void 0,void 0,function*(){const t=window.open("");if([3,11].includes(e.type)){let n="";const o=window.location.protocol+"//om.iflow.meizu.com/service/article/playurl",r=new I(o);r.setQuery("cpEntityId",e.cpEntityId||e.uniqueId),r.setQuery("cpId",e.cpId||e.resourceType);const l=new I(i.a.serverRequest.url);l.setQuery("url",r.toString());const u=yield s.a.get(l.toString());if(200===u.code){const e=u.value;Array.isArray(e)&&e.length&&(n=e[0].mainUrl)}if(n||(n=e.link||e.h5Url),n){if("mp4"===new I(n).suffix()){const e=new I("/v2/html/videoPlayer");e.setQuery("videoUrl",n),t.location.href=e.toString()}else t.location.href=n}else a.a.error("找不到播放地址")}else{if(e.link)return void(t.location.href=e.link);if(e.h5Url)return void(t.location.href=e.h5Url)}})}}),k.push({name:"viewAuthorArticleList",action:function(e){return T(this,void 0,void 0,function*(){h.default.dispatch({type:"modal.toggle",modalName:"authorArticlesPreview",options:e})})}}),k.push({name:"selectAnalysisRule",action:function(e){h.default.dispatch({type:"modal.toggle",modalName:"selectAnalysisRule",options:e})}}),k.push({name:"publicArticle",action:function(){f.a.confirm({title:"发布",content:"编辑后的内容未经过审核，是否发布？",onOk:()=>T(this,void 0,void 0,function*(){yield this.submit(),k.find(e=>"onShelf"===e.name).action.call(this,this.props.formFields)}),okText:"确定",cancelText:"取消"})}}),k.push({name:"publicVideo",action:function(){f.a.confirm({title:"发布",content:"编辑后的内容未经过审核，是否发布？",onOk:()=>T(this,void 0,void 0,function*(){yield h.default.dispatch({type:"fields.setValue",value:{status:1}}),this.submit()}),okText:"确定",cancelText:"取消"})}}),k.push({name:"videoOffShelf",action:function(e){_.call(this,{status:2,contentId:e.contentId,cpId:e.cpId,cpEntityId:e.cpEntityId})}}),k.push({name:"videoOnShelf",action:function(e){_.call(this,{status:1,contentId:e.contentId,cpId:e.cpId,cpEntityId:e.cpEntityId})}});k.push({name:"crawlUrl",action:function(e){return T(this,void 0,void 0,function*(){const t=JSON.parse(JSON.stringify(this.props.fields)),n=t.find(t=>t.keyName===e.keyName),o=n.buttons.find(e=>"crawlUrl"===e.actionName);o.isLoading=!0,o.loadingTime=60,o.tempName="";const r=function(e){h.default.dispatch({type:"table.setValue",value:e})};r({fields:t});const l=function(e){clearInterval(e),o.isLoading=!1,o.tempName=null,r({fields:t})},u=setInterval(()=>{const n=this.props.fields.find(t=>t.keyName===e.keyName).buttons.find(e=>"crawlUrl"===e.actionName);n.isLoading&&n.loadingTime?(o.loadingTime=o.loadingTime-1,o.tempName=o.loadingTime,r({fields:t})):l(u)},1e3),c=yield s.a.post(i.a.crawlUrl.url,{url:this.props.formFields[n.keyName]});if(200===c.code){const e=c.value,n=JSON.parse(JSON.stringify(this.props.formFields)),s=function(e,t){n[e]=t};s("author",e.author),s("content",e.content),t.find(e=>"content"===e.keyName)._key=g.generate(),s("title",e.title),s("contentTitle",e.title),s("cpSource",e.source),s("imgUrls",e.imgMap.map(e=>(e.uid=g.generate(),e.name=e.id,e.status="done",e.thumbUrl=e.url,e))),s("keywords",e.keywords.join(",")),r({fields:t}),h.default.dispatch({type:"fields",value:n}),a.a.success("抓取成功")}else a.a.error(c.message);o.isLoading=!1,r({fields:t})})}}),k.push({name:"copy",action:function(e){const t=this.props.formFields[e.keyName],n=document.createElement("input");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),n.parentElement.removeChild(n)}}),k.push({name:"previewVideo",action:function(e){const t=this.props.formFields[e.keyName];window.open(t,"_blank")}}),k.push({name:"openBatchSet",action:function(e){h.default.dispatch({type:"modal.toggle",modalName:"batchSet",options:e})}}),k.push({name:"newGrabApi",action:function(e){const t=(new I).query(!0).cpId;this.props.history.push("/v2/page/analysis/cp-transfer/cp-api-list/cp-api-manage?cpId="+t)}});const b=function({tableName:e,fields:t}){return T(this,void 0,void 0,function*(){const n=yield s.a.post(i.a.updateTableRow.url,{tableName:e,fields:t});200===n.code?(a.a.success("数据保存成功"),this.props.freshList.call(this)):a.a.error("操作失败: "+n.message)})};k.push({name:"offlineCP",action:function(e){return a.a.error("该功能正在开发中")}}),k.push({name:"onlineCP",action:function(e){return a.a.error("该功能正在开发中")}}),k.push({name:"algorithmContentOnline",action:function(e){b.call(this,{tableName:"T_CONTENT_DIS",fields:{FID:e.FID,FSTATUS:1}}),v.a.freshCache.call(this,e.FID)}}),k.push({name:"algorithmContentOffline",action:function(e){b.call(this,{tableName:"T_CONTENT_DIS",fields:{FID:e.FID,FSTATUS:4}}),v.a.freshCache.call(this,e.FID)}});t.a=k},"./assets/action/freshTableList.ts":function(e,t,n){"use strict";var s=n("./assets/lib/ajax.ts"),i=n("./assets/const/API.ts"),a=n("./node_modules/antd/es/message/index.js"),o=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};n("./common/filter/index.js");const r=n("./node_modules/urijs/src/URI.js");t.a=function(e={}){return o(this,void 0,void 0,function*(){const t=e.exposeType,n=this.props;if(!n.tableName||!n.dbName)throw new Error("Can not find dbName and tableName.");const o=(new r).query(!0),l=n.page||1,u=n.pageSize||10;let c=n.dispatch;const m=i.a.queryTable.url,d={dbName:n.dbName,tableName:n.tableName,offset:(l-1)*u,pageSize:u},p={};if(n.queryFields.forEach(e=>{[null,void 0,""].includes(e.value)||(e.searchMode&&"LIKE"===e.searchMode.toUpperCase()?p[e.keyName]=`%${e.value}%`:p[e.keyName]=e.value)}),Object.keys(o).forEach(e=>{const t=n.fields.find(t=>t.keyName===e);t&&(p[e]=o[e],"number"===t.valueType&&(p[e]=+p[e]))}),Object.keys(p).length&&(d.filter=p),o.sortBy){const e=o.sortOrder||"ASC";d.sortBy=o.sortBy,d.sortOrder=e}if(t){d.exposeType=t;const e=new r(m);Object.keys(d).forEach(t=>{d[t]&&"object"==typeof d[t]?e.setQuery(t,encodeURIComponent(JSON.stringify(d[t]))):e.setQuery(t,d[t])}),window.location.assign(e.toString())}else{c({type:"table.setValue",value:[],key:"list"}),c({type:"table.setValue",value:0,key:"total"}),c({type:"table.setValue",value:!0,key:"isLoading"});const e=yield s.a.post(m,d);if(c({type:"table.setValue",value:!1,key:"isLoading"}),200===e.code&&e.value){const t=e.value;Array.isArray(t.list)&&(c({type:"table.setValue",value:t.list,key:"list"}),c({type:"table.setValue",value:t.total,key:"total"}))}else a.a.error(e.message)}})}},"./assets/action/informServer.ts":function(e,t,n){"use strict";var s=n("./node_modules/antd/es/message/index.js"),i=n("./assets/lib/ajax.ts"),a=n("./assets/const/API.ts"),o=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};const r=n("./node_modules/urijs/src/URI.js");t.a=function(){return o(this,void 0,void 0,function*(){const e=this.props.fields.find(e=>e.isPrimaryKey);if(e&&e.informServer){const t=new r(e.informServer.api),n=new r(a.a.serverRequest.url);n.setQuery("url",t.toString());const o=yield i.a.get(n.toString());200===o.code?s.a.success("刷新缓存成功"):s.a.error("刷新缓存失败，JAVA服务器返回信息："+o.message)}})}},"./assets/action/miscellaneous.ts":function(e,t,n){"use strict";var s=n("./assets/lib/ajax.ts"),i=n("./assets/const/API.ts"),a=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};const o=n("./node_modules/urijs/src/URI.js"),r={freeOrNotCP:[],chargeCP:[],maxExposeAmount:0,isRes:!1,channelOptions:[]},l=[{name:"initOMParameter",action:function(){return a(this,void 0,void 0,function*(){if(!0===r.isRes)return;const e=yield s.a.post(i.a.queryOne.url,{tableName:"T_OM_PARAMETER",selectFields:[{keyName:"FVALUE"}],filter:{FTYPE:"cp",FKEY:"view_count_limit"}});if(200===e.code){if(!e.value.FVALUE)return void console.error("配置平台未填写“收费CP”和“CP浏览量最大值”");r.isRes=!0;const t={};e.value.FVALUE.replace(/[\{\}]/,"").split(",").map(e=>e.trim()).forEach(e=>{const n=e.split(":").map(e=>e.trim().replace(/\'/g,""));t[n[0]]=+n[1]}),r.maxExposeAmount=+t[-1];const n=[],s=Object.keys(t),i=[];for(const e of s)"-1"!==e&&i.push(e);const a=i.join(",");n.push({name:"是",value:a}),r.freeOrNotCP=n,r.chargeCP=i.map(e=>+e),console.log("cache: ",r)}})}},{name:"maxExposeAmount",action:function(){return r.maxExposeAmount}},{name:"freeOrNotCP",action:function(){return r.freeOrNotCP}},{name:"sum-row",action:function(e){return e&&"sum"===e.key?"sum-row":""}},{name:"isFreeOrNotRow",action:function(e){const t=(new o).query(!0);if(!t)return"";let n=t.filter;if(!n)return"";if("string"==typeof n&&(n=JSON.parse(decodeURIComponent(n))),n.FCPID)return"";{const t=r.chargeCP,n=e.FCPID;return t.includes(n)?"green":""}}}];l.push({name:"highlightAddedDistribution",action:function(e){return 0!==e.fliterOrder?"green":""}}),l.push({name:"changeVideoStatus",action:function(){return a(this,void 0,void 0,function*(){yield this.props.dispatch({type:"fields.setValue",value:{status:2}})})}}),l.push({name:"initChannelList",action:function(){return a(this,void 0,void 0,function*(){const e=yield s.a.get(i.a.queryTable.url,{tableName:"T_CHANNEL"});if(200===e.code){const t=e.value.list||[],n=[];return r.subChannelOptions=t.map(e=>(!1===n.some(t=>t.value===e.FCHANNEL_ID)&&n.push({name:e.FNAME,value:e.FCHANNEL_ID}),{name:e.FCNAME,value:e.FID,row:e})),void(r.channelOptions=n)}throw new Error("Can not fetch channel list: "+JSON.stringify(e))})}}),l.push({name:"channelOptions",action:function(){return r.channelOptions}}),l.push({name:"subChannelOptions",action:function(){return r.subChannelOptions}}),t.a=l},"./assets/component/table/List.tsx":function(e,t,n){"use strict";var s=n("./node_modules/react/index.js"),i=n("./node_modules/react-loadable/lib/index.js"),a=n.n(i),o=n("./node_modules/antd/es/spin/index.js"),r=n("./node_modules/antd/es/table/index.js"),l=n("./node_modules/react-redux/es/index.js"),u=n("./node_modules/react-router/es/withRouter.js"),c=n("./assets/action/miscellaneous.ts"),m=n("./assets/action/buttonActions.ts"),d=n("./assets/lib/handy.ts"),p=n("./node_modules/antd/es/menu/index.js"),y=n("./node_modules/antd/es/button/index.js"),f=n("./node_modules/antd/es/tooltip/index.js"),h=n("./node_modules/antd/es/dropdown/index.js"),N=n("./node_modules/antd/es/rate/index.js"),v=n("./node_modules/react-router-dom/es/Link.js"),T=n("./assets/const/MISC.ts");const g=n("./node_modules/lc-time-format/index.js"),E=n("./node_modules/urijs/src/URI.js"),I=n("./assets/img/default.jpg");var S=function(e,t,n,i){let a,o="";if(d.a.isValuePath(i.keyName)&&(e=d.a.getValueByPath(t,i.keyName)),i.isShowRawValue)o=a=e;else if("select"===i.type){if("bit"===i.valueType){if((e=+e)<0)throw new Error("Value type is bit. The value should not negative.");e=d.a.transferIntToBitIndex(e)}if("multiple"===i.mode)o=a=e.map(e=>{const t=i.options.find(t=>t.value===e);return!!t&&t.name}).filter(e=>!1!==e).join(i.joinSymbol||",");else{const t=i.options.find(t=>"number"==typeof t.value?t.value===+e:t.value===e);t?o=a=t.name:a="-"}}else if(["update-time","create-time","date","time"].includes(i.type))a=g(new Date(e),"Y-M-D H:N:S");else if("button"===i.type){const e=i.buttonType||"link",o=[],r=[];for(const a of i.buttons){let i=!0;if(void 0!==a.isShow&&("string"==typeof a.isShow?i=a.isShow(t):a.isShow.keyName?Array.isArray(a.isShow.keyValue)?!1===a.isShow.keyValue.includes(t[a.isShow.keyName])&&(i=!1):a.isShow.keyValue!==t[a.isShow.keyName]&&(i=!1):i=!!a.isShow),a.isShow&&a.isShow.isNotEqual&&(i=!i),!i)continue;const l={className:"link"};if(l.key=a.name,l.type=a.type||e,a.actionName){const e=m.a.find(e=>e.name===a.actionName);l.onClick=e.action.bind(this,t)}if(!0===a.isDisabled&&(l.disabled=!0),a.isDropdown)r.push(s.createElement(p.a.Item,{key:a.actionName+"-"+n},a.name));else if(a.link){const e=new E(a.link.href);Object.keys(a.link.argMap).forEach(n=>{const s=a.link.argMap[n];e.setQuery(n,t[s])});const n=e.toString();o.push(s.createElement(y.a,Object.assign({},l),s.createElement(v.a,{key:a.name,to:n},a.name)))}else{const e=s.createElement(y.a,Object.assign({},l),a.name);a.tooltip?o.push(s.createElement(f.a,{key:a.name,title:a.tooltip.title},e)):o.push(e)}}if(r.length){const n=s.createElement(p.a,{onClick:this.overlayClick.bind(this,t)},r),a={};a.type=i.dropdownType||e,a.icon="ellipsis",o.push(s.createElement(h.a,{key:"dropdown-menu",trigger:["click"],overlay:n},s.createElement(y.a,Object.assign({},a))))}a=s.createElement(y.a.Group,null,o)}else"image"===i.type?e?(i.split&&(e=e.split(",")[0]),a=s.createElement("img",{src:e})):a=i.isBlank?s.createElement("img",{src:T.a}):s.createElement("img",{src:I}):"rate"===i.type?a="text"===i.listType?e:s.createElement(N.a,{disabled:!0,defaultValue:e}):o=a=e;if("string"==typeof a&&i.link){const e={target:"_blank"};if(i.link.target&&(e.target=i.link.target),i.link.query){let n=i.link.prefix,s=new E(n);i.link.query&&s.setQuery(i.link.query.key,t[i.link.query.value]),e.href=s.toString()}else i.link.keyName&&(e.href=t[i.link.keyName]);a=s.createElement("a",Object.assign({},e),a)}let r={style:{}};i.width&&("number"==typeof i.width?r.style.width=i.width+"px":r.style.width=i.width),r.className="field-value",i.hasTooltip||i.tooltip||(r.title=o),"sum"===t.key&&i.maxRed&&c.a.find(e=>e.name===i.maxRed).action()<e&&(r.className+=" max-red");if(i.click){const e=m.a.find(e=>e.name===i.click.actionName);r.onClick=e.action.bind(this,t),r.className+=" clickable"}if(a=s.createElement("span",Object.assign({},r),a),!0===i.hasTooltip||i.tooltip)if(i.tooltip){let e="";i.tooltip.title?e=i.tooltip.title:i.tooltip.keyName&&(e=t[i.tooltip.keyName]),e&&(a=s.createElement(f.a,{arrowPointAtCenter:!0,title:e},s.createElement("span",{className:"clickable"},a)))}else a=s.createElement(f.a,{arrowPointAtCenter:!0,title:o},a);return a},k=n("./assets/lib/page.ts"),C=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};const _=n("./node_modules/urijs/src/URI.js"),b=a()({loader:()=>Promise.all([n.e(3),n.e(5),n.e(36),n.e(35)]).then(n.bind(null,"./assets/component/Modal/EditFormModal.tsx")),loading:()=>s.createElement("div",null,"loading...")});const A=Object(l.b)(e=>{let t=e.table;return t.formFields=e.fields,t},e=>({setValue:(t,n)=>e({type:"table.setValue",value:n,key:t}),setEditFormValue:(t,n)=>e({type:"editForm.setValue",value:n,key:t}),dispatch:e}))(class extends s.Component{constructor(e){super(e),this.showList=[],this.primaryField={},this.pageChange=(e=>{const t=new _;t.setQuery("page",e),this.props.history.push(t.pathname()+"?"+t.query())}),this.pageSizeChange=((e,t)=>{const n=new _;n.setQuery("pageSize",t),n.setQuery("page",1),this.props.history.push(n.pathname()+"?"+n.query())}),this.tableChange=((e,t,n)=>C(this,void 0,void 0,function*(){if("fake"===this.listConfig.pager)return this.props.setValue("pageSize",e.pageSize),void this.props.setValue("page",e.current);const t=new _,s=t.query(!0);if((+s.pageSize||10)!==e.pageSize)return yield this.props.setValue("pageSize",e.pageSize),yield this.props.setValue("page",e.current),"redux"===this.props.queryType?this.freshList():(t.setQuery("page",1),t.setQuery("pageSize",e.pageSize),void this.historyPush(t));if((this.props.page||+s.page||1)!==e.current)return yield this.props.setValue("page",e.current),"redux"===this.props.queryType?this.freshList():(t.setQuery("page",e.current),void this.historyPush(t));const i=s.sortBy,a=s.sortOrder;if(i!==n.field||a!==n.order){if(!n.field)return t.removeQuery(["sortBy","sortOrder"]),void this.historyPush(t);t.setQuery("sortBy",n.field);let e="";return"descend"===n.order&&(e="DESC"),"ascend"===n.order&&(e="ASC"),t.setQuery("sortOrder",e),void this.historyPush(t)}})),this.freshList=e.freshList,k.a.onPageFinished=(()=>C(this,void 0,void 0,function*(){if(console.log("list page finished."),this.freshList&&this.freshList(),this.primaryField=this.props.fields.find(e=>!!e.isPrimaryKey),this.listConfig=this.primaryField.listConfig||{},!this.primaryField)throw new Error("Must provide primary key definition.")}))}shouldComponentUpdate(e){return this.props.isLoading!==e.isLoading||!1===k.a.isSwitching&&!1===e.isLoading}componentDidMount(){return C(this,void 0,void 0,function*(){const e=(new _).query(!0);yield this.props.setValue("pageSize",+e.pageSize||10),yield this.props.setValue("page",+e.page||1);const t=window.location.pathname,n=this.props.history.listen(()=>C(this,void 0,void 0,function*(){if(t!==window.location.pathname)return n(),void console.log("path name has been change. no freshing list follow.");const e=(new _).query(!0);e.page&&e.pageSize&&(this.props.page!==+e.page&&(yield this.props.setValue("page",+e.page)),this.props.pageSize!==+e.pageSize&&(yield this.props.setValue("pageSize",+e.pageSize))),this.freshList()}))})}fieldChange(e,t){this.props.setFieldsValue(e.keyName,t.target.value)}sort(e){return C(this,void 0,void 0,function*(){const t=this.props.sortBy,n=this.props.sortOrder,s=e.keyName;if(t)if(t===s){const e=n?"DESC"===n?"ASC":"DESC":"ASC";yield this.props.setValue("sortOrder",e)}else yield this.props.setValue("sortOrder","DESC"),yield this.props.setValue("sortBy",s);else yield this.props.setValue("sortOrder","DESC"),yield this.props.setValue("sortBy",s);this.freshList()})}historyPush(e){this.props.history.push(e.pathname()+"?"+e.query())}overlayClick(e,t){const n=t.key.split("-"),s=n[0];n[1],m.a.find(e=>e.name===s).action.call(this,e)}render(){if(k.a.isSwitching)return"";const e=(new _).query(!0),t=this.props.fields,n={},i=t.filter(e=>!0!==e.unlistable).map(t=>{let n=t.keyName||t.name;const s={title:t.name,dataIndex:n,render:(e,n,s)=>S.call(this,e,n,s,t),key:t.name||t.keyName};return t.sortable&&(s.sorter=!0),e.sortBy===t.keyName&&("ASC"===e.sortOrder?s.sortOrder="ascend":"DESC"===e.sortOrder?s.sortOrder="descend":s.sortOrder=!1),t.width&&(s.width=t.width),s}),a=this.props.list.slice();let l;!1===this.listConfig.pager?l=!1:"more"===this.listConfig.pager?l=!1:["fake",void 0].includes(this.listConfig.pager)&&(l={total:this.props.total,pageSize:this.props.pageSize,showQuickJumper:!0,current:this.props.page,showSizeChanger:!0});const u=t.filter(e=>!!e.isSum);if(u.length){const e={key:"sum"};e[t.find(e=>void 0===e.unlistable).keyName]="汇总";for(const t of a)for(const n of u)void 0===e[n.keyName]&&(e[n.keyName]=0),e[n.keyName]+=t[n.keyName]||0;a.push(e)}return n.pagination=l,n.columns=i,n.dataSource=a,n.size="middle",n.className="table-list",n.loading=this.props.isLoading,n.onChange=this.tableChange,n.rowKey=this.primaryField.keyName,n.rowClassName=this.primaryField&&this.primaryField.rowClassName?(e,t)=>c.a.find(e=>e.name===this.primaryField.rowClassName.action).action.call(this,e):"",n.bordered=!0,"more"===this.listConfig.pager&&a.length&&!0!==this.props.noMore&&(n.footer=(()=>{let e="更多";n.loading&&(e=s.createElement(o.a,null));const t={className:"more"};return t.onClick=(()=>C(this,void 0,void 0,function*(){yield this.props.setValue("page",this.props.page+1),this.freshList.call(this)})),s.createElement("div",Object.assign({},t),e)})),s.createElement("div",{className:"content-list"},s.createElement(r.a,Object.assign({},n)),s.createElement(b,{freshList:this.freshList}))}}),O=Object(u.a)(A);t.a=O},"./assets/const/API.ts":function(e,t,n){"use strict";const s="/"+n("./common/SYSTEM.js").urlVersion.value+"/api",i={tableQuery:{url:"/table/list",description:"查询mysql表数据，该接口将会失效"},queryTable:{url:"/table/query",description:"查询mysql表数据，优先使用这个",type:"all"},queryOne:{url:"/table/query-one",description:"跟queryTable差不多，但只获取一个"},removeTableRecord:{url:"/table/remove",description:"删除指定fields的数据，可以删除一个或多个"},getByKeyName:{url:"/table/getByKeyName",description:"通过keyName字段去查询表中数据"},tableDistinctQuery:{url:"/table/distinct",description:"滤重方式查询mysql的某个字段"},getOneFromTable:{url:"/table/one",description:"通过主键ID的值，从mysql表中获取单条数据"},updateTableRow:{url:"/table/upsert",description:"更新或新增mysql表中的某条数据，仅支持POST方式"},duplicateRow:{url:"/table/duplicateOne",description:"复制一条纪录到同一个表"},multiTableUpsert:{url:"/table/multi-upsert",description:"可以单次提交多个mysql表的更新或新增"},multiTableSave:{url:"/table/multi-save",description:"可以提交多个表的更新操作，包括新增、删除、更新"},reUploadImage:{url:"/common/re-upload",description:"转发上传图片到java服务器"},serverRequest:{url:"/common/redirect",description:"由于权限和跨域的原因，浏览器不能直接请求某个API，需要用这个API来帮忙请求。"},deleteOneFromTable:{url:"/table/deleteOne",description:"从 mysql 表中删除某条数据"},saveDistribution:{url:"/distribution/save",description:"保存分发运营配置"},pushUpDistribution:{url:"/distribution/pushUp",description:"置顶某条内容"},blockDistribution:{url:"/distribution/block",description:"屏蔽某条内容"},getDistributionStyle:{url:"/distribution/getStyle",description:"获取某条位置的样式"},saveDistributionStyle:{url:"/distribution/saveStyle",description:"保存某条位置的样式"},freshDistributionCache:{url:"/distribution/freshCache",description:"刷新缓存"},crawlUrl:{url:"/crawl/getContent",description:"抓取某个页面的内容，返回json数据",type:"POST"},exportData:{url:"/table/export",description:"下载SQL数据",type:"GET"},importData:{url:"/table/import",description:"上传SQL数据",type:"POST"},saveImage:{url:"/crawl/save-image",description:"保存图片到魅族服务器",type:"POST"}};Object.keys(i).forEach(e=>i[e].url=s+i[e].url),t.a=i},"./assets/const/MISC.ts":function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return i});const s="YYYY-MM-DD HH:mm:ss",i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},"./assets/img/default.jpg":function(e,t,n){e.exports=n.p+"assets/23dec7018c923dc139b7dad1148ff02d.jpg"},"./assets/lib/Component.ts":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var s=n("./node_modules/react/index.js"),i=n("./assets/lib/handy.ts");class a extends s.Component{constructor(e){super(e),i.a.setTitle(e)}}},"./assets/lib/distribution.ts":function(e,t,n){"use strict";var s=n("./node_modules/antd/es/message/index.js"),i=n("./assets/const/API.ts"),a=n("./assets/lib/ajax.ts"),o=n("./assets/lib/handy.ts"),r=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};const l=n("./common/enum/ALGORITHM.js"),u=n("./node_modules/urijs/src/URI.js"),c=n("./node_modules/shortid/index.js"),m={getDefaultCondition(e){return r(this,void 0,void 0,function*(){let t=[];const n=yield a.a.get(i.a.getByKeyName.url,{dbName:"MEIZU_CONTENTS",tableName:"T_CONTENT_DIS_CONDITION",keyValue:e.FID,keyName:"FDISID"});if(Array.isArray(n.value)){t=n.value.map(e=>{0===e.FCPID&&(e.FCPID=null);const t=e.FSUB_CATEGORY;return e.FSUB_CATEGORY={value:t,options:[]},e._action="set",e._key=c.generate(),e});for(let e of t)e.FCATEGORY&&(e.FSUB_CATEGORY.options=yield this.getSubCategory(e.FCATEGORY))}return t})},getFirstCategory(){return r(this,void 0,void 0,function*(){let e=[];const t=yield a.a.get(i.a.tableDistinctQuery.url,{dbName:"MEIZU_CONTENTS",tableName:"T_CONTENT_CATEGORY",keyName:"FCATEGORY"});return 200===t.code&&Array.isArray(t.value)&&(e=t.value.map(e=>({name:e.FCATEGORY,value:e.FCATEGORY}))).push({name:"无",value:null}),e})},getSubCategory(e){return r(this,void 0,void 0,function*(){const t=yield a.a.get(i.a.getByKeyName.url,{dbName:"MEIZU_CONTENTS",tableName:"T_CONTENT_CATEGORY",keyName:"FCATEGORY",keyValue:e});if(200===t.code){if(Array.isArray(t.value)){const e=t.value.map(e=>({name:e.FSUB_CATEGORY,value:e.FSUB_CATEGORY}));return e.push({name:"无",value:null}),e}return[]}s.a.error(t.message)})},getConditions(e){return r(this,void 0,void 0,function*(){e=e||this.props.selectedAlgorithm;const t=(new u).query(!0).disId,n=yield a.a.get(i.a.getByKeyName.url,{dbName:"MEIZU_CONTENTS",tableName:"T_CONTENT_DIS_CONDITION",keyValue:t,keyName:"FDISID"});if(200===n.code){if(Array.isArray(n.value)){const o=n.value.filter(e=>!e.FALGOVER).map(e=>({category:e.FCATEGORY||null,cpId:0===e.FCPID?null:e.FCPID,subCategory:e.FSUB_CATEGORY||null,type:void 0===e.FTYPE?null:e.FTYPE,id:e.FID})),r=n.value.filter(e=>!!e.FALGOVER),u={},c={tableName:"T_CONTENT_DIS_CONDITION",rows:[]};for(const e of l){const n=e.value;if(!n)continue;const s=r.find(e=>e.FALGOVER===n);if(!s||[null,void 0,""].includes(s.FCATEGORYID)){const i=yield m.getCategory.call(this,n);if(!1===Array.isArray(i))throw new Error("Can not find categories, can not set default category id.");const a=i.find(e=>"推荐"===e.name);let o=null,r="";a&&(o=a.id,r=a.name);const l={_action:"set",FCATEGORYID:o,FDISID:t,FCATEGORY:r,FSUB_CATEGORY:"",FALGOVER:n,FCPID:e.cpId};s&&(l.FID=s.FID),c.rows.push(l)}}if(c.rows.length){const t=[c],n=yield a.a.post(i.a.multiTableSave.url,{tables:t});return 200!==n.code?void s.a.error("设置默认分类失败:"+n.message):(console.log("refresh conditions value after setting default category value."),yield m.getConditions.call(this,e))}for(const e of l){const t=e.value;if(!t)continue;const n=r.find(e=>e.FALGOVER===t);u[t]={category:n.FCATEGORYID||null,type:void 0===n.FTYPE?null:n.FTYPE,id:n.FID}}console.log("cpConditions: ",u),yield this.props.dispatch({type:"contentAlgorithm.setValue",value:{serverConditions:n.value,conditions:o,cpConditions:u}})}}else s.a.error("获取当前过滤条件错误："+n.message)})},getCategory(e){return r(this,void 0,void 0,function*(){const t=e||"noAlgorithm";if(this.props.category[t])return this.props.category[t];let n;if("noAlgorithm"===t){const e=yield a.a.post(i.a.queryTable.url,{tableName:"T_CONTENT_CATEGORY"});if(200!==e.code)return void s.a.error("获取无算法的分类失败："+e.message);const t=new Set;for(const n of e.value.list)t.add(n.FCATEGORY);this.props.dispatch({type:"contentAlgorithm.setValue",key:"firstCategory",value:[...t]}),n=e.value.list}else{const t=new u("http://om.iflow.meizu.com/service/dis/condition");t.setQuery("algover",e);const o=yield a.a.get(i.a.serverRequest.url,{url:t.toString()});if(200!==o.code)return void s.a.error("获取分类列表失败："+o.message);n=o.value.categories.map(e=>(e.id=(e.id||"")+"",e))}const r=o.a.copyObj(this.props.category);return r[t]=n,yield this.props.dispatch({type:"contentAlgorithm.setValue",key:"category",value:r}),r[t]})},freshCache(e){return r(this,void 0,void 0,function*(){let t=yield a.a.post(i.a.freshDistributionCache.url,{disId:e});200===t.code?s.a.success("刷新成功"):s.a.error(t.message)})}};t.a=m},"./assets/lib/page.ts":function(e,t,n){"use strict";var s=n("./assets/reducer/index.ts"),i=n("./assets/action/miscellaneous.ts"),a=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};const o=n("./common/filter/index.js"),r=(n("./node_modules/shortid/index.js"),n("./node_modules/urijs/src/URI.js")),l={isSwitching:!1,initFieldOptions(e){for(const t of e)if("string"==typeof t.options){const e=i.a.find(e=>e.name===t.options);t.options=e.action()}},setPageConfig:function(e){return a(this,void 0,void 0,function*(){if(this.isSwitching=!0,yield s.default.dispatch({type:"table.setValue",value:{isLoading:!0}}),e.init)for(const t of e.init){yield i.a.find(e=>e.name===t).action()}const t=(new r).query(!0),n=e.dbName||"MEIZU_CONTENTS",a=e.tableName||"",u=e.fields||[],c=e.isAbleAddItem||!1,m=e.listUrl||"",d=e.editModalWidth||720,p=e.queryType||"url";let y=e.queryFields;this.initFieldOptions(u),yield s.default.dispatch({type:"table.setValue",value:{dbName:n,tableName:a,fields:u,isAbleAddItem:c,list:[],listUrl:m}});let f=t.filter;if("string"==typeof f?f=JSON.parse(decodeURIComponent(f)):f||(f={}),y||(a?y=o[a]:console.log("no filter defined.")),y){y=JSON.parse(JSON.stringify(y)),this.initFieldOptions(y);const e=Object.keys(f);for(const t of y){const n=t.keyName;if(n)if(e.includes(n))t.value=f[n];else if(void 0!==t.defaultValue&&(t.value=t.defaultValue,"select"===t.type)){if(t.options.find(e=>e.value===t.defaultValue));else if("number"==typeof t.defaultValue)t.value=t.options[t.defaultValue].value;else if(!0===Array.isArray(t.defaultValue));else if(null!==t.defaultValue)throw console.log("filter field: ",t),new Error("can not recognize this default value.")}}}else y=[];yield s.default.dispatch({type:"table.setValue",value:{queryType:p,queryFields:y,editModalWidth:d}}),l.onPageFinished(),this.isSwitching=!1})},onPageFinished:function(){console.log("page finished.")}};t.a=l},"./assets/page/AuthorArticles.tsx":function(e,t,n){"use strict";n.r(t);var s=n("./node_modules/react/index.js"),i=n("./assets/lib/Component.ts"),a=n("./assets/lib/page.ts"),o=n("./assets/lib/ajax.ts"),r=n("./assets/const/API.ts"),l=n("./assets/reducer/index.ts"),u=n("./node_modules/antd/es/message/index.js"),c=function(e,t,n,s){return new(n||(n=Promise))(function(i,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})};const m=n("./node_modules/urijs/src/URI.js"),d=window.location.protocol+"//om.iflow.meizu.com/service/author/content";var p=function(){return c(this,void 0,void 0,function*(){const e=(new m).query(!0),t=this.props.page,n=this.props.pageSize||10,s=e.authorId||this.props.authorId;if(!s)throw new Error("author id is required.");const i=new m(d);i.setQuery("authorId",s),i.setQuery("page",t),i.setQuery("pageSize",n);const a=new m(r.a.serverRequest.url);a.setQuery("url",i.toString()),l.default.dispatch({type:"table.setValue",key:"isLoading",value:!0});const c=yield o.a.get(a.toString());if(200===c.code){const e=c.value.items||[],t=this.props.list.concat(e);l.default.dispatch({type:"table.setValue",key:"list",value:t}),e.length<n&&l.default.dispatch({type:"table.setValue",key:"noMore",value:!0})}else u.a.error("获取列表失败："+c.message);l.default.dispatch({type:"table.setValue",key:"isLoading",value:!1})})},y=n("./assets/component/table/List.tsx");const f=n("./common/listFields/AUTHOR_ARTICLES.js");t.default=class extends i.a{constructor(e){super(e);const t={fields:f};a.a.setPageConfig(t)}render(){return s.createElement("div",{className:"author-articles-page"},s.createElement(y.a,{freshList:p}))}}},"./common/enum/ALGORITHM.js":function(e,t){e.exports=[{value:"",name:"无算法"},{value:"uc_algover",name:"UC",categoryName:"UC分类",cpId:2,noContentType:!0},{value:"baidu_algover",name:"百度",categoryName:"百度分类",cpId:76},{value:"jrtt_algover",name:"今日头条",categoryName:"头条分类",cpId:200},{value:"yidian_algover",name:"一点资讯",categoryName:"一点资讯分类",cpId:81,noContentType:!0}]},"./common/enum/ANALYSIS_RULE_STATUS.js":function(e,t){e.exports=[{name:"未验证",value:1},{name:"验证中",value:2},{name:"验证成功",value:3}]},"./common/enum/CONTENT_SOURCES.js":function(e,t){e.exports=[{name:"今日头条",value:1},{name:"网易",value:2},{name:"凤凰新闻(爬)",value:3},{name:"界面新闻",value:4},{name:"搜狐新闻",value:5},{name:"网易有料",value:6}]},"./common/enum/CONTENT_STATUS.js":function(e,t){e.exports=[{name:"上架",value:1},{name:"下架",value:0},{name:"删除",value:3},{name:"敏感",value:7}]},"./common/enum/CONTENT_TYPES.js":function(e,t){e.exports=[{name:"文章",value:0},{name:"图集",value:2},{name:"视频",value:11}]},"./common/enum/CP_SOURCES.js":function(e,t){e.exports=[{value:1,name:"LOFTER",keyName:"LOFTER",hideWhenEdit:!0},{value:2,name:"UC",keyName:"UC",hideWhenEdit:!0},{value:4,name:"魅族资讯",keyName:"MEIZU"},{value:8,name:"新浪",keyName:"SINA",hideWhenEdit:!0},{value:16,name:"魅族视频",keyName:"FLYME_VIDEO",hideWhenEdit:!0},{value:32,name:"魅族推荐",keyName:"MEIZU_RECOMMEND",hideWhenEdit:!0},{value:64,name:"腾讯新闻",keyName:"TENCENT",hideWhenEdit:!0},{value:65,name:"360视频",keyName:"RES_360",hideWhenEdit:!0},{value:66,name:"腾讯浏览器",keyName:"QQ_BROWSER",hideWhenEdit:!0},{value:67,name:"橘子娱乐",keyName:"JUZI",hideWhenEdit:!0},{value:68,name:"360搜索",keyName:"SEARCH_360",hideWhenEdit:!0},{value:69,name:"腾讯快报",keyName:"KB",hideWhenEdit:!0},{value:70,name:"360文章",keyName:"APP_360",hideWhenEdit:!0},{value:71,name:"UC视频",keyName:"UC_VIDEO",hideWhenEdit:!0},{value:72,name:"快手视频",keyName:"KS_VIDEO",hideWhenEdit:!0},{value:73,name:"轻芒阅读",keyName:"QINGMANG",hideWhenEdit:!0},{value:74,name:"优品",keyName:"YOUPIN"},{value:75,name:"英威诺",keyName:"INVENO",hideWhenEdit:!0},{value:76,name:"百度",keyName:"BAIDU",hideWhenEdit:!0},{value:77,name:"百度视频",keyName:"BAIDU_VIDEO",hideWhenEdit:!0},{value:78,name:"凤凰新闻",keyName:"IFENG_MEIZU",hideWhenEdit:!0},{value:79,name:"网易有料",keyName:"163_NEWS",hideWhenEdit:!0},{value:80,name:"腾讯语音",keyName:"TENCENT_VOICE",hideWhenEdit:!0},{value:81,name:"一点资讯",keyName:"YIDIAN",hideWhenEdit:!0},{value:82,name:"唯彩看球",keyName:"VIPC",hideWhenEdit:!0},{value:83,name:"唔哩头条",keyName:"WULI",hideWhenEdit:!0},{value:84,name:"今日头条",hideWhenEdit:!0,keyName:"JINRITOUTIAO"},{value:85,name:"西瓜视频",hideWhenEdit:!0,keyName:"TOUTIAO_XIGUA"},{value:101,name:"里世界",keyName:"LISHIJIE",hideWhenEdit:!0},{value:102,name:"好兔视频",keyName:"HAOTU",hideWhenEdit:!0}]},"./common/enum/RULE_SCRIPT_TYPES.js":function(e,t){e.exports=[{value:1,name:"模板"},{value:2,name:"内置脚本"},{value:3,name:"外置脚本"},{value:4,name:"联接脚本"}]},"./common/enum/VIDEO_CP_SOURCES.js":function(e,t){e.exports=[{name:"西瓜视频",value:200}]},"./common/filter sync \\/[A-Z_]*\\.js$":function(e,t,n){var s={"./ANALYSIS_RULE.js":"./common/filter/ANALYSIS_RULE.js","./ANALYSIS_SCRIPT.js":"./common/filter/ANALYSIS_SCRIPT.js","./AUTH_USER.js":"./common/filter/AUTH_USER.js","./CHANNEL_DISTRIBUTION.js":"./common/filter/CHANNEL_DISTRIBUTION.js","./CONTENT_FILTER.js":"./common/filter/CONTENT_FILTER.js","./CP_API_LIST.js":"./common/filter/CP_API_LIST.js","./CP_LIST.js":"./common/filter/CP_LIST.js","./GRAB_RULES.js":"./common/filter/GRAB_RULES.js","./SETTING_PARAM.js":"./common/filter/SETTING_PARAM.js","./SPECIAL_ARTICLES.js":"./common/filter/SPECIAL_ARTICLES.js","./T_AUTHOR.js":"./common/filter/T_AUTHOR.js","./T_CHANNEL.js":"./common/filter/T_CHANNEL.js","./T_CONTENTS.js":"./common/filter/T_CONTENTS.js","./T_CONTENT_DIS.js":"./common/filter/T_CONTENT_DIS.js","./T_CONTENT_DIS_DISPLAY.js":"./common/filter/T_CONTENT_DIS_DISPLAY.js","./T_CONTENT_VIEW_STATUS.js":"./common/filter/T_CONTENT_VIEW_STATUS.js","./T_CONTENT_VIEW_SUMMARY.js":"./common/filter/T_CONTENT_VIEW_SUMMARY.js","./T_CP.js":"./common/filter/T_CP.js","./T_CRAWL_RULE.js":"./common/filter/T_CRAWL_RULE.js","./T_FUNCTION.js":"./common/filter/T_FUNCTION.js","./T_FUNCTION_RULE.js":"./common/filter/T_FUNCTION_RULE.js","./VIDEO.js":"./common/filter/VIDEO.js"};function i(e){var t=a(e);return n(t)}function a(e){var t=s[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}i.keys=function(){return Object.keys(s)},i.resolve=a,e.exports=i,i.id="./common/filter sync \\/[A-Z_]*\\.js$"},"./common/filter/ANALYSIS_RULE.js":function(e,t,n){const s=n("./common/enum/ANALYSIS_RULE_STATUS.js");e.exports=[{name:"序号",keyName:"id"},{name:"表达式",keyName:"regexp"},{name:"状态",keyName:"status",type:"select",options:s}]},"./common/filter/ANALYSIS_SCRIPT.js":function(e,t,n){const s=n("./common/enum/RULE_SCRIPT_TYPES.js");e.exports=[{name:"序号",keyName:"id"},{name:"名称",keyName:"name"},{name:"类型",keyName:"type",type:"select",options:s}]},"./common/filter/AUTH_USER.js":function(e,t){e.exports=[{name:"用户名称",keyName:"name"},{name:"备注",keyName:"remark"}]},"./common/filter/CHANNEL_DISTRIBUTION.js":function(e,t){e.exports=[{name:"分发渠道",type:"select",keyName:"FCHANNEL_ID"},{name:"新旧分发",keyName:"FFLAG",defaultValue:1,isShow:!1}]},"./common/filter/CONTENT_FILTER.js":function(e,t,n){const s=n("./common/enum/CP_SOURCES.js"),i=n("./common/enum/CONTENT_TYPES.js"),a=n("./common/enum/CONTENT_SOURCES.js"),o=n("./common/enum/CONTENT_STATUS.js");e.exports=[{name:"文章ID",keyName:"id"},{name:"CP文章ID",keyName:"uniqueId"},{name:"文章标题",keyName:"title"},{name:"作者",keyName:"author"},{name:"类型",keyName:"category"},{name:"标签",keyName:"label"},{name:"关键字",keyName:"keywords"},{name:"内容CP",keyName:"resourceTypes",type:"select",options:s,mode:"multiple",defaultValue:[null]},{name:"内容源",keyName:"contentSourceIdParam",type:"select",options:a,isShow:{type:"condition",keyName:"resourceTypes",value:4}},{name:"内容类型",type:"select",keyName:"type",options:i,defaultValue:null},{name:"状态",keyName:"status",type:"select",options:o,defaultValue:1},{name:"时间范围",keyName:"scope",type:"select",defaultValue:1,options:[{name:"1日",value:1},{name:"3日",value:3},{name:"7日",value:7},{name:"15日",value:15},{name:"30日",value:30},{name:"自定义",value:-1}]},{name:"时间",keyName:"scopeRange",keyNames:["customScope_start","customScope_end"],type:"dateRange",isShow:{type:"condition",value:-1,keyName:"scope",isRequired:!0}},{name:"排序",keyName:"order",type:"select",defaultValue:null,options:[{name:"浏览量",value:"viewCount"},{name:"上架时间",value:"putdate"},{name:"转化率",value:"conversionV1"}]},{keyName:"add-360-video",type:"button",name:"添加视频",actionName:"openVideoInput"},{keyName:"baidu-content-input",type:"button",name:"百度入库",link:{href:"/v2/page/content-manage/baidu-content-input"}}]},"./common/filter/CP_API_LIST.js":function(e,t){e.exports=[{keyName:"id",name:"ID"},{keyName:"newGrabApi",name:"新增",actionName:"newGrabApi",type:"button"}]},"./common/filter/CP_LIST.js":function(e,t){e.exports=[{keyName:"cpId",name:"CP ID"},{keyName:"cp",name:"CP 名称"}]},"./common/filter/GRAB_RULES.js":function(e,t,n){n("./common/enum/CP_SOURCES.js"),n("./common/enum/CONTENT_TYPES.js"),n("./common/enum/CONTENT_SOURCES.js"),n("./common/enum/CONTENT_STATUS.js");e.exports=[{name:"ID",keyName:"id"}]},"./common/filter/SETTING_PARAM.js":function(e,t,n){n("./common/enum/ANALYSIS_RULE_STATUS.js");e.exports=[{name:"类型",keyName:"type"},{name:"键",keyName:"key"},{name:"名称",keyName:"name"}]},"./common/filter/SPECIAL_ARTICLES.js":function(e,t,n){const s=n("./common/enum/CP_SOURCES.js"),i=n("./common/enum/CONTENT_TYPES.js"),a=n("./common/enum/CONTENT_SOURCES.js"),o=n("./common/enum/CONTENT_STATUS.js");e.exports=[{name:"文章ID",keyName:"id"},{name:"CP文章ID",keyName:"uniqueId"},{name:"文章标题",keyName:"title"},{name:"作者",keyName:"author"},{name:"类型",keyName:"category"},{name:"标签",keyName:"label"},{name:"关键字",keyName:"keywords"},{name:"内容CP",keyName:"resourceTypes",type:"select",options:s,mode:"multiple",defaultValue:[null]},{name:"内容源",keyName:"contentSourceIdParam",type:"select",options:a,isShow:{type:"condition",keyName:"resourceTypes",value:4}},{name:"内容类型",type:"select",keyName:"type",options:i,defaultValue:null},{name:"状态",keyName:"status",type:"select",options:o,defaultValue:1},{name:"时间范围",keyName:"scope",type:"select",defaultValue:null,options:[{name:"1日",value:1},{name:"3日",value:3},{name:"7日",value:7},{name:"15日",value:15},{name:"30日",value:30},{name:"自定义",value:-1}]},{name:"时间",keyName:"scopeRange",keyNames:["customScope_start","customScope_end"],type:"dateRange",isShow:{type:"condition",value:-1,keyName:"scope",isRequired:!0}}]},"./common/filter/T_AUTHOR.js":function(e,t){e.exports=[{name:"作者ID",type:"text",keyName:"FID"},{name:"名称",type:"text",keyName:"FNAME",searchMode:"LIKE"},{name:"分类",keyName:"FCATEGORY"},{name:"渠道",type:"select",keyName:"FSUPPORT_BIZ",tableName:"T_CP",searchMode:"bitwise",options:[{value:1,name:"资讯"},{value:2,name:"浏览器"},{value:3,name:"趣视频"},{value:4,name:"钱包"}]},{name:"作者详情",type:"select",keyName:"FOPEN_TYPE",tooltip:"客户端的作者详情页面打开方式"},{name:"内容类型",type:"select",keyName:"FCONTENT_SIGN"},{name:"星级",keyName:"FRECOMMEND_STAR",type:"rate",defaultValue:5}]},"./common/filter/T_CHANNEL.js":function(e,t){e.exports=[]},"./common/filter/T_CONTENTS.js":function(e,t){e.exports=[{name:"内容标题",type:"text",keyName:"FTITLE",searchMode:"LIKE"},{name:"内容ID",type:"text",keyName:"FCONTENT_ID"}]},"./common/filter/T_CONTENT_DIS.js":function(e,t){e.exports=[{name:"分发渠道",type:"select",keyName:"FCHANNEL_ID"}]},"./common/filter/T_CONTENT_DIS_DISPLAY.js":function(e,t){e.exports=[{keyName:"FID",isPrimaryKey:!0},{keyName:"FCONTENT_ID"}]},"./common/filter/T_CONTENT_VIEW_STATUS.js":function(e,t){const n=new Date,s=n.getFullYear()+"";let i=n.getMonth()+1;i<10?i="0"+i:i+="",e.exports=[{keyName:"FSTAT_DATE",name:"统计月份",type:"month-select",duration:{start:-6,end:0,min:"201801"},defaultValue:s+i},{keyName:"FCPID",name:"是否收费来源",type:"select",options:"freeOrNotCP",defaultValue:0,searchMode:"IN",status:"hide"}]},"./common/filter/T_CONTENT_VIEW_SUMMARY.js":function(e,t){const n=new Date,s=n.getFullYear()+"";let i=n.getMonth()+1;i<10?i="0"+i:i+="",e.exports=[{keyName:"FSTAT_DATE",name:"统计月份",type:"month-select",duration:{start:-6,end:0,min:"201801"},defaultValue:s+i},{keyName:"BIZ_TYPE",name:"业务类型",type:"select"},{keyName:"FCPID",name:"是否收费来源",type:"select",options:"freeOrNotCP",defaultValue:0,searchMode:"IN"},{name:"导出CSV",type:"button",icon:"file-excel",actionName:"downloadCSV"}]},"./common/filter/T_CP.js":function(e,t){e.exports=[{name:"来源id",keyName:"FID"}]},"./common/filter/T_CRAWL_RULE.js":function(e,t){e.exports=[{name:"规则ID",type:"text",keyName:"FID"},{name:"网站名称",type:"text",keyName:"FSITE_NAME",searchMode:"LIKE"},{name:"调试",type:"button",icon:"code-o",actionName:"openCrawlTester"},{name:"导入",type:"button",icon:"download",actionName:"import"},{name:"导出",type:"button",icon:"upload",actionName:"export"}]},"./common/filter/T_FUNCTION.js":function(e,t){e.exports=[{name:"转码ID",keyName:"FID"},{name:"方法名称",keyName:"FFUNCTION"},{name:"导入",type:"button",icon:"download",actionName:"import",args:{tableName:"T_FUNCTION_RULE"}},{name:"导出",type:"button",icon:"upload",actionName:"export",args:{tableName:"T_FUNCTION_RULE"}}]},"./common/filter/T_FUNCTION_RULE.js":function(e,t){e.exports=[{name:"规则ID",keyName:"FID"},{name:"JS方法名",keyName:"FMETHOD"}]},"./common/filter/VIDEO.js":function(e,t,n){n("./common/enum/CP_SOURCES.js"),n("./common/enum/CONTENT_STATUS.js");const s=n("./common/enum/VIDEO_CP_SOURCES.js");e.exports=[{name:"内容平台ID",keyName:"id"},{name:"CP内容ID",keyName:"cpEntityId"},{name:"标题",keyName:"title"},{name:"作者",keyName:"author"},{name:"分类",keyName:"category"},{name:"关键字",keyName:"keywords",placeholder:"多个以英文逗号隔开"},{name:"内容来源",keyName:"cpId",type:"select",options:s,defaultValue:[200],mode:"multiple",status:"hide"},{name:"状态",keyName:"status",type:"select",options:[{name:"上架",value:1},{name:"下架",value:2}],defaultValue:1},{name:"发布时间",keyName:"publishTime",type:"date",placeholder:"选择开始时间至今",sendFormat:"M/D/YYYY",notSendIfEmpty:!0}]},"./common/filter/index.js":function(e,t,n){const s=n("./common/filter sync \\/[A-Z_]*\\.js$");let i={};s.keys().forEach(e=>{if(/index\.js/.test(e))return;let t=e.match(/[\/]([^\/]+)\.js$/)[1];i[t]=s(e)}),e.exports=i},"./common/listFields/AUTHOR_ARTICLES.js":function(e,t){e.exports=[{name:"文章ID",keyName:"id",isPrimaryKey:!0,listConfig:{pager:"more"}},{name:"标题",keyName:"title",link:{keyName:"h5Url"}},{name:"作者",keyName:"author"},{name:"作者ID",keyName:"authorId"},{name:"链接",keyName:"h5Url",unlistable:!0}]}}]);
//# sourceMappingURL=32.bundle.js.map